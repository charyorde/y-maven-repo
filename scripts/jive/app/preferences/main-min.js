define("jive.JAF.Preferences",["jive.JAF.Preferences.Model","jive.JAF.PreferencesView"],function(b,a){return jive.oo.Class.extend(function(c){jive.conc.observable(this);c.init=function(f,d){this.source=new b();var e=this;this.defaultView=new a(d);this.defaultView.addListener("app.service.wire.submit",function(g){e.emit("app.service.wire.submit",g)});this.defaultView.addListener("app.service.wire.cancel",function(g){e.emit("app.service.wire.cancel",g)});this.defaultView.addListener("app.service.wire.none");this.source.addListener("app.preferences.get.pref.view",function(g){if(g.customView){e.emit("app.service.wire.none");e.emit("app.preferences.get.custom.view",g.viewUrl)}else{e.defaultView.addListener("app.preferences.save",function(h){e.source.setPreferences(h)});e.defaultView.edit_app_preferences(f,g)}});this.source.addListener("app.preferences.set.all",function(){e.emit("app.preferences.default.saved",{message:"Your preferences have been saved."})});this.source.getPreferencesView(f.instanceAppID)}})});