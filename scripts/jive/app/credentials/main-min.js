define("jive.JAF.Configuration.CredentialsMainV2",["jive.JAF.Configuration.CredentialsForm","jive.JAF.CoreContainer.CredentialsModel"],function(a,b){return jive.oo.Class.extend(function(c){jive.conc.observable(this);c.init=function(e){var d=this;var h=e.instanceAppID;var f=e.serviceAlias;d.completionCallback=e.completionCallback;this.model=new b({alias:e.serviceAlias});var g=e.domTarget;this.view=new a({domTarget:g});this.view.addListener("app.credentials_done",function(i){d.model.persist(h,i)});this.view.addListener("app.credentials_cancelled",function(){d.emitFailure("The user denied this operation.")});this.model.get_credentials(h,f).addCallback(function(i){d.view.render(i)});this.model.addListener("app.credentials.persisted.success",function(i){d.view.msgSuccess(i);d.completionCallback(i)});this.model.addListener("app.credentials.persisted.failed",function(i){d.view.msgFailed(i);d.completionCallback(i)})};this.emitFailure=function(f){var e=this;var d={alias:e.serviceAlias};d.error={code:401,message:f};e.view.msgCancelled(d);e.completionCallback(d)};this.activate=function(){this.view.activate()};this.completed=function(){return this.view.completed()}})});