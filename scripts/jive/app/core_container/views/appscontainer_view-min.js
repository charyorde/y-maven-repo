define("jive.JAF.CoreContainer.AppsContainerView",["jive.JAF.Configuration.ConfigureMainV2","jive.Apps.PlacePicker.Main","jive.JAF.Alerts.AlertMainV2"],function(a,c,b){return jive.AbstractView.extend(function(d){jive.conc.observable(this);var e={};this.getEmbeddedContext=function(f){return e[f]};this.setEmbeddedContext=function(f,g){e[f]=g};this.deleteEmbeddedContext=function(f){delete e[f]};this.prepareMarketContext=function(f){e["market-app"]={target:{type:"embed"},jive:f};return{embeddedID:"market-app"}};this.init=function(f,g){this.commonContainer=f;this.options=g;this.bounds={maxWidth:1200,maxHeight:1200,minWidth:350,minHeight:150};this.addListener("app.apply.alert",this.handleAppAlert)};this.render=function(){};this.handleAppsMarketInstall=function(){};this.renderApp_=function(f,h,l,j){var o=this;if(!f){return}var i=new b(h,$j(f.currentGadgetEl_));if(i.hasBlockingAlerts()){o.emit("app.apply.alert",i)}else{var g=this.createRenderParams_(h);var k=h.appURL;var m=l||function(){};var n=j||{};this.commonContainer.navigateGadget(f,k,n,g,m)}};this.renderAppEE_=function(i,l,j,h,f){var g=new b(l,i);if(g.hasBlockingAlerts()){this.emit("app.apply.alert",g);return false}else{var k=l.appURL||"";this.getAppFeatures(k,function(m){this.renderAppEE_impl(i,l,j,m,h,f)});return true}};this.renderAppEE_impl=function(m,i,k,f,n,l){k=k||{};var h=this.isOpenSocialFeatureRequired("2.5",(f||{}),"embedded-experiences");var o=d.constructEEDataModel(i,k);if(h){k=d.constructOpenSocialEEContext(k);if(!!k.appContext){o.context=k.appContext}}var g=this.createRenderParams_(i);var p=n||function(){};var q=l||{};var j={};j[osapi.container.ee.RenderParam.GADGET_RENDER_PARAMS]=g;j[osapi.container.ee.RenderParam.GADGET_VIEW_PARAMS]=q;this.commonContainer.ee.navigate(m,o,j,p,k.containerContext)};d.constructOpenSocialEEContext=function(g){var f={};if(g.jive&&g.jive.content){f.containerContext={};f.containerContext[osapi.container.ee.Context.ASSOCIATED_CONTEXT]={};f.containerContext[osapi.container.ee.Context.ASSOCIATED_CONTEXT]=g.jive.content}if(g&&g.target&&g.target.context){f.appContext=g.target.context}return f};d.constructEEDataModel=function(l,j){var k=l.appURL;var g=l.view;var i={};i.gadget=k;i.context=j;if(j&&(j.target||j.display)){var h=j.display||{};var f=j.target||{};if(f.type&&f.type==="embed"){f.type=osapi.container.ee.TargetType.GADGET}i[osapi.container.ee.DataModel.PREFERRED_EXPERIENCE]={display:h,target:f};if(j.target&&!j.target.hasOwnProperty("view")){j.target.view=l.view}}return i};this.computeAppDimensions=function(k,g){var j;if(g){j=g.replace(".","_")}var f=(j&&k.heightByView&&k.heightByView[j])||k.height||k.actionHeight;var i=(j&&k.widthByView&&k.widthByView[j])||k.width||k.actionWidth;var h=false;if(f===9999&&i===9999){h=true}return{height:f,width:i,isMaximum:h}};d.createRenderParams_=function(j){var g=osapi.container.RenderParam;var i={};var f=j.view;i[g.VIEW]=f;var h=this.computeAppDimensions(j,f);i[g.HEIGHT]=h.height;i[g.WIDTH]=h.width;i[g.USER_PREFS]=j.userPrefs;if(typeof(window.__JAF_DEBUG)!=="undefined"&&window.__JAF_DEBUG===0){i[g.NO_CACHE]=j.hasOwnProperty(g.NO_CACHE)?j.nocache:false}return i};this.getRealTitle=function(h,g){var f="";if((h.title||g)&&h.actionLabel){f=(g?g:h.title)+" : "+h.actionLabel}else{if(h.title||g){f=g?g:h.title}else{if(h.actionLabel){f=h.actionLabel}}}return f};this.getAppFeatures=function(g,h){var f=this;this.commonContainer.preloadGadget(g,function(i){if(!i[g]||i[g].error){h.call(f,{error:i[g].error})}else{var j={};var k=i[g]["modulePrefs"];if(k&&k.features){j=k.features}h.call(f,j)}})};this.isOpenSocialFeatureRequired=function(g,k,l){var i="opensocial-"+g;var j=k[i]||null;if(j&&j.required){return true}if(l){var f=k[l]||null;if(f&&f.params.specificationVersion){var h=f.params.specificationVersion;h=$j.trim(h.toString());if(h.length>g.length){h=h.substring(0,g.length)}if(h===g){return true}}}return false};this.sendNotification=function(g){g=g||{};var h=g.message;var f=g.severity||"info";if(typeof(h)!="undefined"){$j("<p/>").html(h).message({style:f})}};this.setTitle=function(){};this.maximizeApp=function(){};this.reload=function(){};this.closeApp=function(){};this.resizeContainerHeight=function(){};this.resizeContainerWidth=function(){};this.requestNavigateTo=function(){};this.scrollIntoView=function(){};this.handleAppAlert=function(f){};this.initPlacePicker=function(f,h){var g=new c(f);g.showPicker(h)};this.initUserPicker=function(g,j){var i={multiple:false};g=$j.extend(i,g);var h=new jive.UserPicker.SelectPeopleView();var f=function(k){h.close();j(k)};h.setOptions(g).addListener("select",f).open()};this.invokeCredentials=function(){};this.destroyCredentials=function(){};this.invokeSettings=function(){};this.destroySettings=function(){};this.closeModal=function(f){};this.setModalTitle=function(f){d.setWhichModalTitle();whichTitle.text(f)};d.setWhichModalTitle=function(){var f=".js-app-title-main";var g=$j(".js-app-title > *");whichTitle=f?g.filter(f):null};d.enableSparkline=function(g){if(g.developmentApp){this.sparklineEnabled=true;var f=null;$j(".j-app-sparkline").show();$j(".j-app-sparkline").hover(function(){me=$j(this);img=$j("img",me);if(f){window.clearInterval(f)}f=window.setInterval(function(){me.css("background-image","url("+img.attr("src").replace(/ts=\d+/,"ts="+new Date().getTime())+")")},250)},function(){if(f){window.clearInterval(f)}f=null;me.css("background-image","")})}else{this.sparklineEnabled=false}};this.refresh=function(){this.emit("app.reload");this.displayRefreshMsg(true)};this.displayRefreshMsg=function(f,j){var g=f?"info":"error";var i=f?"appframework.app.development.refresh":"error.general";var h=jive.apps.container.renderMessage({messageKey:i});this.sendNotification({message:h,severity:g})};this.handleConfigurationDialog=function(h,i){var g=this;var k=h.getApp();var f=$j(jive.apps.container.blockingAlertView());if(k.configurationError){f.find("#j-app-blocking-alert-submit").hide();f.find("#j-app-blocking-alert-cancel").addClass("j-btn-callout")}var j=new a({app:k,domTarget:f.find("#app-blocking-alert-detail")});j.addListener("app.service.wire.cancel",function(l){$j("#j-app-blocking-alert-cancel").click(function(){var m=jive.apps.container.renderMessage({messageKey:"appframework.app.configure.cancel"});g.sendNotification({severity:"warn",message:m});$j(".j-modal-close-top").click()})});j.addListener("app.service.wire.submit",function(l){$j("#j-app-blocking-alert-submit").click(l.callback)});j.addListener("app.configure.success",function(){var l=jive.apps.container.renderMessage({messageKey:"appframework.app.configure.success"});g.sendNotification({severity:"info",message:l});if(i&&i.configureCallback){i.configureCallback(true)}g.emit("app.reload",false)});j.addListener("app.configure.failed",function(){var l=jive.apps.container.renderMessage({messageKey:"appframework.app.configure.failure"});g.sendNotification({severity:"error",message:l});if(i&&i.configureCallback){i.configureCallback(false)}});$j("#j-app-modal-parent iframe").css({display:"none"});$j("#j-app-modal-parent").append(f)};this.resizeModal=function(f,h,g){};this.restoreChromeNav=function(){};this.hideChromeNav=function(){};this.getRenderedApp=function(){};this.getMaximumHeight=function(){};this.getMaximumWidth=function(){};this.boundedHeight=function(f){f=(f+"").match(/\d+/)[0]/1;var g=Math.min(Math.max(f,this.bounds.minHeight),this.bounds.maxHeight);return g};this.boundedWidth=function(f){f=(f+"").match(/\d+/)[0]/1;var g=Math.min(Math.max(f,this.bounds.minWidth),this.bounds.maxWidth);return g};d.delayedRunner=function(h,g,f){var j=new Date().getTime();var i=window.setInterval(function(){var k=new Date().getTime();if(k-j>1500||f()){h();window.clearInterval(i)}},g)};d.recenter=function(i,g){g=!($j.browser.msie&&$j.browser.version<9)&&g;var f=i.height();var h=i.width();i.css({position:"fixed",top:"50%",marginTop:i.outerHeight()/-2,left:"50%",marginLeft:i.outerWidth()/-2});if(g){i.animate({marginLeft:h/-2,marginTop:f/-2},{duration:300,queue:false})}else{i.css({marginLeft:h/-2,marginTop:f/-2},{duration:300,queue:false})}}})});