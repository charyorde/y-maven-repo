jive.namespace("util");(function(c){function b(d){return typeof d=="object"&&"nodeType" in d&&d.nodeType===1&&d.cloneNode}function a(){var d=new jive.conc.Promise();d.emitSuccess.apply(d,arguments);return d}jive.util={escapeHTML:function(d){if(d instanceof c||b(d)){return c("<div/>").html(d).html()}else{return c("<div/>").text(String(d)).html()}},unescapeHTML:function(d){return c("<div/>").html(String(d)).text()},convertElementsToValues:function(e){var d=[];c.each(c(e),function(){d.push(c(this).val())});return d},createDynamicForm:function(e){var d=$j("<form />");if(e.method.toLowerCase()!="get"){d.attr("method",e.method)}var f=e.url.split(/[&?]/);d.attr("action",f[0]);f.shift();f.forEach(function(g){var h=g.split(/[=]/);d.append($j('<input name="'+h[0]+'" type="hidden"/>').val(decodeURIComponent(h[1])))});return d},createAndSubmitDynamicForm:function(d){jive.util.createDynamicForm(d).appendTo($j(document.body)).submit()},securedPost:function(d){var e=new jive.conc.Promise();$j.ajax({url:jive.rest.url("/legacy_token/"+d),type:"POST",dataType:"json",success:function(g){var f={"jive.token.name":d};f[d]=g[0];e.emitSuccess(f)},error:function(g,h,f){e.emitError(g,h,f)}});return e},securedForm:function(f){var d=$j(f),e=f.find('input[name="jive.token.name"]').val();var g=e?jive.util.securedPost(e):a({});return g.map(function(h){d.find('input[name="'+e+'"]').val(h[e]);return d})},truncateStr:function(f,e,d){e=e||49;d=d||"...";return f.length>e?f.substring(0,e)+d:f},lazyLoadJSBySels:function(g,f,d,e){$j(document).ready(function(){var h=false;$j(g.join(", ")).one(f,function(j){var i=$j(this);if(!h){define([d],function(){if(e){e()}i.trigger(j.type)});h=true}if(j.type=="click"||j.type=="submit"){j.preventDefault()}})})},lazyLoadJSByFns:function(e,d,f){$j(document).ready(function(){e.forEach(function(l){var h=false;var g=l.split(".");var j=g.pop();jive.namespace.apply(window,[g.join(".")]);function i(m){return m.reduce(function(o,n){return o[n]},window)}var k=i(g);k[j]=function(){define([d],function(){if(!h){if(f){f()}i(g)[j](arguments);h=true}})}})})},extractDataAttributes:(function(d,g,f){function e(h){if(g.test(h)){return h==="true"?true:false}else{if(f.test(h)){return JSON.parse(h)}else{return h}}}return function(i,j){var h={};$j.each($j(i)[0].attributes,function(){if(d.test(this.name)){var k=this.name.replace(d,"");!j&&(k=k.camelize());h[k]=e(this.value)}});return h}})(/^data-/,/^(true|false)$/i,/^\{/i),separateScripts:(function(){var f=/(<script[^>]*>)([\s\S]*?)<\/script>/ig,d=/\s+src=["']([^'">]+)['"]/i,g=/\s+type=["']([^'">]+)['"]/i,e=/^text\/javascript/i;return function(i,k){var h=0;function j(){h+=1;return"separateScripts-dep-"+(new Date()).getTime()+"-"+h}var l=j(),n=[l];var m=i.replace(f,function(q,p,o){var r=(p.match(g)||[])[1],t=(p.match(d)||[])[1],s;if(!r||r.match(e)){if(t&&!k){kjs.load(t,n.slice(-1).concat(l));n.push(t.split("?")[0])}else{if(o&&!k){s=j();kjs.run(c.globalEval.bind(c,o),n.slice(-1).concat(l),[s]);n.push(s)}}return""}else{return q}});return[m,function(o){if(o){kjs.run(o,n.slice(-1).concat(l))}kjs.sat(l)}]}})(),withoutScripts:function(d){var e=jive.util.separateScripts(d,true);return e[0]},fitTextWithinNode:function(k,g,i){var f=0,h=k.length,j=h,d=j*0.2,e;do{if(j<k.length){g.text(k.slice(0,j)+"\u2026")}else{g.text(k.slice(0,j))}if((g.outerHeight()>i.outerHeight())||g.outerWidth()>i.outerWidth()){h=j}else{f=j}e=j;j=Math.floor((f+h)/2)}while(f<h-d||e!=f)},setFavicon:function(d){$j("link[rel~=shortcut]").remove();$j('<link rel="shortcut icon" type="image/x-icon" />').attr("href",d).appendTo("head")},equalsIgnoreCaseAndPadding:function(e,d){return e&&d&&e.toLowerCase().trim()==d.toLowerCase().trim()}}})(jQuery);