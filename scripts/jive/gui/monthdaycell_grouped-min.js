jive.gui.MonthDayGroupedCell=function(i,d,t,l){var g=this;var j=new JiveProjectTooltip(i.getTaskManager().getProjectID(),"jive-note-checkpoint-body","jive-note-tasks-body","jive-note-additems-body","","","","","",true);var m=i.getLanguageManager().getActiveLanguage();var s=document.createElement("DIV");var r=l.getDate();var c="month_day_cell_number no-underline";if(l.getDate()==1){r=m.shortMonth(l.getMonth())+" "+r;c+=" start_month_day_cell_number font-color-notify"}var u=new jive.ext.y.HashTable();var h=new jive.ext.y.HashTable();var b=document.createElement("SPAN");b.getDate=function(x){return function(){return x}}(l);b.setAttribute("class",c);b.className=c;var q=document.createElement("SPAN");q.id="add_link";q.setAttribute("class","month_day_cell_number_link");q.className="month_day_cell_number_link";q.appendChild(document.createTextNode("[ + ]"));jive.ext.x.xDisplayNone(q);b.appendChild(q);b.appendChild(document.createTextNode(r));s.appendChild(b);var p=0;var o=document.createElement("A");var w=document.createElement("span");var v=document.createElement("span");o.appendChild(w);w.className="jive-icon-sml jive-icon-checkpoint";w.setAttribute("class","jive-icon-sml jive-icon-checkpoint");o.href="javascript:;";o.className="jive-cal-checkpoint jiveTT-hover-checkpoint clearfix";o.setAttribute("class","jive-cal-checkpoint jiveTT-hover-checkpoint clearfix");v.setAttribute("class","j-508");s.appendChild(o);jive.ext.x.xDisplayNone(o);var a=0;var e=document.createElement("A");var n=document.createElement("span");var k=document.createElement("span");e.appendChild(n);n.className="jive-icon-sml jive-icon-task";n.setAttribute("class","jive-icon-sml jive-icon-task");e.href="javascript:;";e.className="jiveTT-hover-tasks no-underline clearfix";e.setAttribute("class","jiveTT-hover-tasks no-underline clearfix");k.setAttribute("class","j-offscreen");s.appendChild(e);jive.ext.x.xDisplayNone(e);var f=document.createElement("DIV");f.href="javascript:;";s.appendChild(f);jive.ext.x.xDisplayNone(f);jive.ext.x.xAddEventListener(e,"mouseover",function(x){return function(P){var M=j.getDOM();while(M.childNodes.length>0){M.removeChild(M.childNodes[0])}var Q=document.createElement("strong");var y=(e!=1)?_jive_project_i18n["project.calendar.tasks"]:_jive_project_i18n["project.calendar.task"];var D=i.getTaskManager();D.dateI18nTask(g.getDate(),function(T){Q.appendChild(document.createTextNode(T+" - "+a+" "+y))});var F=document.createElement("UL");var H=g.getTasks();for(var L=0;L<H.length;L++){var A=H[L];var E=document.createElement("LI");E.className="clearfix";E.setAttribute("class","clearfix");var O=document.createElement("A");O.className="jiveTT-hover-user jive-username-link";O.href=A.getAssignedTo().getURL();var R=document.createElement("IMG");R.className="jive-avatar";R.setAttribute("class","jive-avatar");if(A.getAssignedTo().getID()>0){R.src=CS_BASE_URL+"/people/"+A.getAssignedTo().getUsername()+"/avatar/22.png"}else{if(A.getAssignedTo().getID()==-12345){R.src=CS_BASE_URL+"/images/jive-avatar-disabled.png";R.setAttribute("height",22);R.setAttribute("width",22)}else{R.src=CS_BASE_URL+"/people/guest/avatar/22.png"}}O.appendChild(R);var K=document.createElement("SPAN");if(A.getAssignedTo().getID()>0){var S=document.createElement("A");S.href=A.getAssignedTo().getURL();S.className="jiveTT-hover-user jive-username-link";S.setAttribute("class","jiveTT-hover-user jive-username-link");S.appendChild(document.createTextNode(A.getAssignedTo().getFullName()));S.setAttribute("data-userId",A.getAssignedTo().getID())}else{var S=document.createTextNode(A.getAssignedTo().getFullName())}var N=document.createElement("A");N.href=A.getURL();N.className="j-task-link";N.appendChild(document.createTextNode(A.getSubject()));K.appendChild(S);K.appendChild(N);E.appendChild(O);E.appendChild(K);F.appendChild(E);if(i.getProjectCache().getProjects()[0].isEditable()){var I=document.createElement("P");I.className="clearfix";I.task=A;var J=document.createElement("A");J.href=CS_BASE_URL+"/edit-task!input.jspa?project="+A.getProjectID()+"&task="+A.getID();J.appendChild(document.createTextNode(_jive_project_i18n["global.edit"]));var C=document.createElement("A");C.onclick=function(){jiveControl.getTaskManager().deleteTask(this.parentNode.task.getID(),this.parentNode.task.isParent());return false};C.href="javascript:void(0);";C.appendChild(document.createTextNode(_jive_project_i18n["global.delete"]));I.appendChild(J);I.appendChild(C);if(!A.isComplete()){var G=document.createElement("A");G.onclick=function(){jiveControl.getTaskManager().markTaskComplete(this.parentNode.task.getID(),this.parentNode.task.isParent());return false};G.href="javascript:void(0);";G.appendChild(document.createTextNode(_jive_project_i18n["project.task.mark.complete"]));I.appendChild(G);if(A.getAssignedTo().getID()!=i.getUserID()&&A.getAssignedTo().getID()<1&&A.getAssignedTo().getID()!=-12345){var z=document.createElement("A");z.onclick=function(){jiveControl.getTaskManager().takeTask(this.parentNode.task.getID());return false};z.href="javascript:void(0);";z.appendChild(document.createTextNode(_jive_project_i18n["project.task.assign.to.me"]));I.appendChild(z)}}if(A.isComplete()){var B=document.createElement("A");B.onclick=function(){jiveControl.getTaskManager().markTaskInComplete(this.parentNode.task.getID());return false};B.href="javascript:void(0);";B.appendChild(document.createTextNode(_jive_project_i18n["task.incomplete.link"]));I.appendChild(B)}K.appendChild(I)}}M.appendChild(Q);M.appendChild(F)}}(l));jive.ext.x.xAddEventListener(o,"mouseover",function(x){return function(F){var C=j.getCheckPointDOM();while(C.childNodes.length>0){C.removeChild(C.childNodes[0])}var I=document.createElement("strong");var L=(p!=1)?_jive_project_i18n["project.calendar.checkpoints"]:_jive_project_i18n["project.calendar.checkpoint"];var y=i.getTaskManager();y.dateI18nTask(g.getDate(),function(P){I.appendChild(document.createTextNode(P+" - "+p+" "+L))});var G=document.createElement("UL");var E=g.getCheckPoints();var O=jiveControl.getCheckPointManager().getCanCreate();for(var D=0;D<E.length;D++){var H=E[D];var M=document.createElement("LI");M.className="clearfix";var K=document.createElement("DIV");var z=document.createElement("STRONG");var B=document.createElement("span");z.appendChild(B);B.className="jive-icon-med jive-icon-checkpoint";B.setAttribute("class","jive-icon-med jive-icon-checkpoint");z.appendChild(document.createTextNode(H.getName()));K.appendChild(z);if(O){var A=document.createElement("div");A.className="j-cplink clearfix";var J=document.createElement("A");J.href=CS_BASE_URL+"/edit-checkpoint!input.jspa?project="+H.getProject().getID()+"&checkPointID="+H.getID();J.appendChild(document.createTextNode(_jive_project_i18n["global.edit"]));var N=document.createElement("A");N.href=CS_BASE_URL+"/delete-checkpoint!input.jspa?project="+H.getProject().getID()+"&checkPointID="+H.getID();N.appendChild(document.createTextNode(_jive_project_i18n["global.delete"]));A.appendChild(J);A.appendChild(N);K.appendChild(A)}M.appendChild(K);G.appendChild(M)}C.appendChild(I);C.appendChild(G)}}(l));jive.ext.x.xAddEventListener(s,"mouseover",function(x){var F=jiveControl.getCheckPointManager().getCanCreate();var y=jiveControl.getTaskManager().getCanCreate();if(!i.getProjectCache().getProjects()[0].isEditable()||(!F&&!y)){$j("#jiveTT-note-additems").hide();return}var z=j.getCreateLinkDOM();while(z.childNodes.length>0){z.removeChild(z.childNodes[0])}var E=document.createElement("div");E.id="jive-note-add-item-body";if(F){var B=document.createElement("span");B.className="jive-icon-med jive-icon-checkpoint";var A=document.createElement("A");A.className="";A.href="#";A.onclick=function(){jiveControl.getCheckPointManager().addCheckPoint(g.getDate().getTime());return false};A.appendChild(document.createTextNode(_jive_project_i18n["project.checkPoint.create.link"]));E.appendChild(B);E.appendChild(A)}if(y){var D=document.createElement("span");D.className="jive-icon-med jive-icon-task";var C=document.createElement("A");C.href="#";C.onclick=function(){jiveControl.getTaskManager().addTask(g.getDate().getTime());return false};C.appendChild(document.createTextNode(_jive_project_i18n["project.task.create.link"]));E.appendChild(D);E.appendChild(C)}z.appendChild(E)});s.mouseover=function(){if(typeof(jive)!="undefined"){var y=s.getAttribute("class");if(y==null){y==""}if(i.getProjectCache().getProjects()[0].isEditable()){if(y.indexOf("jiveTT-hover-")==-1){s.setAttribute("class",y+" jiveTT-hover-additems");s.className=y+" jiveTT-hover-additems"}}try{if(!s.overed){s.outColor=s.style.backgroundColor}if(!i.isReadOnly()&&t.getItemVisibility()&&t.hasAddView()){jive.ext.x.xDisplayBlock(q)}s.style.backgroundColor=s.overColor;s.overed=true}catch(x){}}};s.mouseout=function(){if(typeof(jive)!="undefined"){try{jive.ext.x.xDisplayNone(q);s.style.backgroundColor=s.outColor;s.overed=false}catch(x){}}};s.updateText=function(){var x=i.getLanguageManager().getActiveLanguage();var z=l.getDate();if(l.getDate()==1){var y=b.childNodes[0];z=x.shortMonth(l.getMonth())+" "+z;while(b.childNodes.length>0){b.removeChild(b.childNodes[0])}b.appendChild(y);b.appendChild(document.createTextNode(z))}};s.getDate=function(x){return function(){return x}}(l);s.dropPoint=function(x,A){if(A!=null){var C=new Date();C.setTime(s.getDate().getTime());C.setHours(A.getHours());C.setMinutes(A.getMinutes());C.setSeconds(A.getSeconds());C.setMilliseconds(A.getMilliseconds());var D=C.getTime()-A.getTime()}if(A!=null&&D!=0&&jive.model.isEvent(x)){var z=new Date();z.setTime(x.getStart().getTime());var B=new Date();B.setTime(x.getEnd().getTime());var y=B.getTime()-z.getTime();z.setTime(z.getTime()+D);B.setTime(z.getTime()+y);x.setStart(z);x.setEnd(B);x.confirm()}else{if((A==null||D!=0)&&jive.model.isTask(x)){if(A!=null){var C=new Date();C.setTime(x.getDueDate().getTime()+D);x.setDueDate(C)}else{var C=new Date();C.setTime(s.getDate().getTime());x.setDueDate(C)}x.confirm()}}};s.appendTaskDOM=function(x){u.put(x.getTask().getID(),x.getTask());jive.ext.x.xAddEventListener(e,"mouseout",j.cancelTooltip);a++;jive.ext.x.xDisplayNone(x);while(e.childNodes.length>1){e.removeChild(e.childNodes[1])}var y=(a!=1)?_jive_project_i18n["project.calendar.tasks"]:_jive_project_i18n["project.calendar.task"];e.appendChild(document.createTextNode(""+a+""));jive.ext.x.xDisplayBlock(e)};this.appendTaskDOM=s.appendTaskDOM;s.removeTaskDOM=function(x){u.clear(x.getTask().getID());a--;if(a==0){jive.ext.x.xDisplayNone(e)}};this.removeTaskDOM=s.removeTaskDOM;s.getTasks=function(){return u.toArray(jive.model.isTask)};this.getTasks=s.getTasks;e.getTasks=g.getTasks;s.getCheckPoints=function(){return h.toArray(jive.model.isCheckPoint)};this.getCheckPoints=s.getCheckPoints;o.getCheckPoints=s.getCheckPoints;s.appendEventDOM=function(x){var y=x.getEvent();for(var z=0;z<s.childNodes.length;z++){if($def(s.childNodes[z].getEvent)){if(s.childNodes[z].getEvent().getStart()>y.getStart()){s.insertBefore(x,s.childNodes[z]);break}}}if(z==s.childNodes.length){s.appendChild(x)}};s.appendCheckPointDOM=function(x){h.put(x.getCheckPoint().getID(),x.getCheckPoint());jive.ext.x.xAddEventListener(o,"mouseout",j.cancelTooltip);p++;jive.ext.x.xDisplayNone(x);while(o.childNodes.length>1){o.removeChild(o.childNodes[1])}var y=(p!=1)?_jive_project_i18n["project.calendar.checkpoints"]:_jive_project_i18n["project.calendar.checkpoint"];o.appendChild(document.createTextNode(""+p+""));jive.ext.x.xDisplayBlock(o)};s.countVisibleItems=function(){return g.getTasks().length+g.getCheckPoints().length+1};this.countVisibleItems=s.countVisibleItems;jive.ext.x.xAddEventListener(q,"click",function(x,y){return function(z){x.notifyAddEventClicked(y.getDate());jive.ext.x.xStopPropagation(z)}}(d,b),true);jive.ext.x.xAddEventListener(s,"click",function(x,y){return function(){x.notifyDayClicked(y.getDate())}}(d,b),false);jive.ext.x.xAddEventListener(s,"mouseover",s.mouseover);jive.ext.x.xAddEventListener(s,"mouseout",s.mouseout);this.getDate=s.getDate;this.getDOM=function(){return s}};