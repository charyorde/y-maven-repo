jive.namespace("search");(function(d){var l=jive.search,k=jive.app.url({path:"/api/core/v3"}),h={content:{url:k+"/search/contents",validParams:["count","startIndex","sort"],validFilters:["search","type","tag","author","place","after"],defaults:{collapse:"true",fields:"rootType,type,subject,author,question,answer,parentPlace,parentContent,highlightSubject,highlightBody,highlightTags,published,updated,replyCount,likeCount,viewCount,visibleToExternalContributors,binaryURL"}},people:{url:k+"/search/people",validParams:["count","startIndex","sort"],validFilters:["search","nameonly"],defaults:{}},places:{url:k+"/search/places",validParams:["count","startIndex","sort"],validFilters:["search","type","tag"],defaults:{}}};function e(){return k}function j(m){return h[m].url}function b(m,o){var n=d.getJSON(m,o).done(function(p){if(p.links&&p.links.next){n.next=b.bind(this,p.links.next,{})}n.returnedDate=new Date().getTime()});n.query=m+"?"+d.param(o);n.sentDate=new Date().getTime();return n}function i(r,q){if(!h.hasOwnProperty(r)){throw new Error("Invalid type, must be content, people, or places")}if(!q){throw new Error("Must provide params to query")}var p=d.extend({},h[r].defaults),m=h[r].validParams;var n=l.getUrl(r);m.forEach(function(s){if(q[s]){p[s]=q[s]}});var o=q.filter;if(o instanceof Array){o=o.map(function(s){return s.replace(/^after\((.*)\)$/,function(t,u){return"after("+g(u)+")"})})}p.filter=o;return b(n,p)}function a(n,m){var o=JSON.stringify(n);return d.ajax({type:"POST",url:k+"/search/monitor",data:o,async:!m,contentType:"application/json",dataType:"json"})}function c(o,n,m){if(!o.hasOwnProperty("filter")){o.filter=[]}if(d.isArray(m)){m=m.join(",")}o.filter.push(n+"("+m+")")}var f={day:1,week:7,month:30,quarter:90,year:365};function g(r){var n=86400000;var o=new Date();var m=new Date(o.getFullYear(),o.getMonth(),o.getDate());var q=m.getTime();var s=f[r];if(!s){return false}var p=new Date(q-n*s).toISOString();return p.replace(/Z$/,"+0000")}if(!Date.prototype.toISOString){(function(){function m(o){var n=String(o);if(n.length===1){n="0"+n}return n}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+m(this.getUTCMonth()+1)+"-"+m(this.getUTCDate())+"T"+m(this.getUTCHours())+":"+m(this.getUTCMinutes())+":"+m(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1000).toFixed(3)).slice(2,5)+"Z"}}())}l.query=i;l.logMonitoring=a;l.getBaseUrl=e;l.getUrl=j})(jQuery);