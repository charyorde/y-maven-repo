var JiveTaskList=$Class.extend({init:function(h,d,a,f,g,e,i,b,c){this.containerID=h;this.completeURL=d;this.incompleteURL=a;this.takeURL=f;this.deleteURL=g;this.taskListURL=e;this.deleteConfirmMsg=i;this.unauthMsg=b;this.errorMsg=c;this.start=0},toggleTaskDetails:function(a){$j("#jive-task-body-"+a).toggle();if($j("#jive-task-body-"+a+":visible").size()){$j("#jive-task-"+a+"-less").css({display:""});$j("#jive-task-"+a+"-more").css({display:"none"});$j("#jive-task-"+a).addClass("jive-task-open")}else{$j("#jive-task-"+a+"-more").css({display:""});$j("#jive-task-"+a+"-less").css({display:"none"});$j("#jive-task-"+a).removeClass("jive-task-open")}},markTaskComplete:function(b,d){var a=this,c=$j("#jive-task-"+b);$j("#jive-task-checkbox-"+b).prop("disabled",true);c.addClass("jive-task-markcomplete");$j.post(a.completeURL,{task:b},function(e){$j.ajax({type:"GET",url:a.taskListURL,data:{start:a.start,filter:a.filter},cache:false,success:function(f){a._insertHTML(f,d);if(c.hasClass("jive-task-overdue")){a.emit("overdueTaskComplete",b)}}})})},markTaskIncomplete:function(b,d){var a=this,c=$j("#jive-task-"+b);$j("#jive-task-checkbox-"+b).prop("disabled",true);$j("#jive-task-"+b).addClass("jive-task-markincomplete");$j.post(a.incompleteURL,{task:b},function(e){$j.ajax({type:"GET",url:a.taskListURL,data:{start:a.start,filter:a.filter},cache:false,success:function(f){a._insertHTML(f,d);if(!c.hasClass("jive-task-overdue")){a.emit("overdueTaskIncomplete",b)}}})})},takeTask:function(b){var a=this;$j.ajax({url:this.takeURL,type:"POST",data:{task:b},success:function(){a.reload()},error:function(c){if(c.status==403){alert(a.unauthMsg)}else{if(c.status==500){alert(a.errorMsg)}}}})},deleteTask:function(b){if(confirm(this.deleteConfirmMsg)){var a=this;$j.ajax({url:this.deleteURL,type:"POST",data:{task:b},success:function(){a.reload()},error:function(c){if(c.status==403){alert(a.unauthMsg)}else{if(c.status==500){alert(a.errorMsg)}}}})}},reloadAndHighlight:function(b,c){var a=this;$j.ajax({url:this.taskListURL,type:"GET",cache:false,data:{start:this.start,filter:this.filter,ownerID:this.ownerID,projectID:this.projectID},success:function(d){a._insertHTML(d,c);$j('[id="'+b+'"]').effect("highlight")},error:function(d){if(d.status==403){alert(a.unauthMsg)}else{if(d.status==500){alert(a.errorMsg)}}}})},reload:function(b){var a=this;$j.ajax({url:this.taskListURL,type:"GET",cache:false,data:{start:this.start,filter:this.filter,mode:this.mode,ownerID:this.ownerID,projectID:this.projectID},success:function(c){a._insertHTML(c,b)},error:function(c){if(c.status==403){alert(a.unauthMsg)}else{if(c.status==500){alert(a.errorMsg)}}}})},setStart:function(a){this.start=a},setFilter:function(a){this.filter=a;this.start=0},setMode:function(a){this.mode=a;this.start=0},setOwnerID:function(a){this.ownerID=a;this.start=0},setProjectID:function(a){this.projectID=a;this.start=0},_scripts:/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,_insertHTML:function(b,d){var c=b.replace(this._scripts,"");var a=$j('[id="'+this.containerID+'"]').html(c);jive.rte.renderedContent.emit("renderedContent",a);if(d){d()}}});jive.conc.observable(JiveTaskList.prototype);