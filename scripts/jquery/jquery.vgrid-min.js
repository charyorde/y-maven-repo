(function(h){function b(t){var q=t.data("_vgchild");var p=t.width();var w=[[0,p,0]];var u=0,s,r,v;q.each(function(x){s=h(this);r=o(s);v=f(w,r[0]);w=k(w,v,r);u=Math.max(u,v[1]+r[1]);s.data("_vgleft",v[0]);s.data("_vgtop",v[1])});t.data("_vgwrapheight",u);g(t)}function f(t,s){var u=t.concat().sort(i);var p=u[u.length-1][2];for(var r=0,q=u.length;r<q;r++){if(u[r][2]>=p){break}if(u[r][1]-u[r][0]>=s){return[u[r][0],u[r][2]]}}return[0,p]}function k(t,p,s){var u=t.concat().sort(i);var v=[p[0],p[0]+s[0],p[1]+s[1]];for(var r=0,q=u.length;r<q;r++){if(v[0]<=u[r][0]&&u[r][1]<=v[1]){delete u[r]}else{u[r]=c(u[r],v)}}return e(u,v)}function i(q,p){if(!q||!p){return 0}return((q[2]==p[2]&&q[0]>p[0])||q[2]>p[2])?1:-1}function d(q,p){if(!q||!p){return 0}return(q[0]>p[0])?1:-1}function e(t,p){var u=t.concat([p]).sort(d);var q=[];for(var s=0,r=u.length;s<r;s++){if(!u[s]){continue}if(q.length>0&&q[q.length-1][1]==u[s][0]&&q[q.length-1][2]==u[s][2]){q[q.length-1][1]=u[s][1]}else{q.push(u[s])}}return q}function c(q,p){if(q[0]>=p[0]&&q[0]<p[1]||q[1]>=p[0]&&q[1]<p[1]){if(q[0]>=p[0]&&q[0]<p[1]){q[0]=p[1]}else{q[1]=p[0]}}return q}function o(r){var p=r.width();var q=r.height();p+=Number(r.css("margin-left").replace("px",""))+Number(r.css("padding-left").replace("px",""))+Number(r.get(0).style.borderLeftWidth.replace("px",""))+Number(r.css("margin-right").replace("px",""))+Number(r.css("padding-right").replace("px",""))+Number(r.get(0).style.borderRightWidth.replace("px",""));q+=Number(r.css("margin-top").replace("px",""))+Number(r.css("padding-top").replace("px",""))+Number(r.get(0).style.borderTopWidth.replace("px",""))+Number(r.css("margin-bottom").replace("px",""))+Number(r.css("padding-bottom").replace("px",""))+Number(r.get(0).style.borderBottomWidth.replace("px",""));return[p,q]}function g(q){var p=q;var r=p.data("_vgchild").length*(p.data("_vgopt").delay||0)+p.data("_vgopt").time||500;var s=p.css("overflow");p.stop();if(p.height()<p.data("_vgwrapheight")){if(h.browser.msie){p.height(p.data("_vgwrapheight"))}else{p.animate({height:p.data("_vgwrapheight")+"px"},(p.data("_vgopt").time||500),"easeOutQuart");p.css("overflow",s)}}else{clearTimeout(p.data("_vgwraptimeout"));p.data("_vgwraptimeout",setTimeout(function(){if(h.browser.msie){if(p.data("_vgwrapheight")){p.height(p.data("_vgwrapheight"))}}else{p.animate({height:p.data("_vgwrapheight")+"px"},(p.data("_vgopt").time||500),"easeOutQuart");p.css("overflow",s)}},r))}}function n(q){var p;q.each(function(r){p=h(this);p.css({position:"absolute",left:~~p.data("_vgleft")+"px",top:~~p.data("_vgtop")+"px"})})}function m(v,u,p,s){var w=h(v).parent();var x=false;var q=v.length;var r,t,y;for(r=0;r<q;r++){t=h(v[r]);y=t.position();if(y.left!=t.data("_vgleft")||y.top!=t.data("_vgtop")){x=true}}if(x){if(typeof(w.data("_vgopt").onStart)=="function"){w.data("_vgopt").onStart()}v.each(function(A){var z=h(this);var B={duration:p,easing:u};if(v.size()-1==A){B.complete=w.data("_vgopt").onFinish||null}clearTimeout(z.data("_vgtimeout"));z.data("_vgtimeout",setTimeout(function(){z.animate({left:z.data("_vgleft")+"px",top:z.data("_vgtop")+"px"},B)},A*s))})}}function a(q){var p=q;clearTimeout(p.data("_vgtimeout"));b(p);p.data("_vgtimeout",setTimeout(function(){if(p.data("_vgopt")){m(p.data("_vgchild"),p.data("_vgopt").easeing||"linear",p.data("_vgopt").time||500,p.data("_vgopt").delay||0)}},500))}function l(p,r){var q=h("<span />").text(" ").attr("id","_vgridspan").hide().appendTo("body");q.data("size",q.css("font-size"));q.data("timer",setInterval(function(){if(q.css("font-size")!=q.data("size")){q.data("size",q.css("font-size"));r(p)}},1000))}function j(p,r){p.bind("vgrid-added",function(){p.find("img").bind("load",function(){r(p)})});p.trigger("vgrid-added");var q=p.append;var s=p.prepend;p.append=function(){q.apply(p,arguments);p.trigger("vgrid-added")};p.prepend=function(){s.apply(p,arguments);p.trigger("vgrid-added")}}h.fn.extend({vgrid:function(s){var q=h(this);var r=s||{};var u=h(window);var p={width:u.width(),height:u.height()};q.data("_vgopt",r);q.data("_vgchild",q.find("> *"));q.data("_vgdefchild",q.data("_vgchild"));q.css({position:"relative",width:"auto"});b(q);n(q.data("_vgchild"));if(q.data("_vgopt").fadeIn){var t=(typeof(q.data("_vgopt").fadeIn)=="object")?q.data("_vgopt").fadeIn:{time:q.data("_vgopt").fadeIn};q.data("_vgchild").each(function(w){var v=h(this);v.css("display","none");setTimeout(function(){v.fadeIn(t.time||250)},w*(t.delay||0))})}q.data("_vgresizehandler",function(x){var y=h(window);var w=y.width();var v=y.height();if(q.data("_vgchild")&&(w!=p.width||v!=p.height)){a(q);p.width=w;p.height=v}});u.resize(q.data("_vgresizehandler"));if(r.useLoadImageEvent){j(q,a)}if(r.useFontSizeListener){l(q,a)}return q},vgrefresh:function(t,r,p,q){var s=h(this);if(s.data("_vgchild")){s.data("_vgchild",s.find("> *"));s.data("_vgchild").css("position","absolute");b(s);r=typeof(r)=="number"?r:s.data("_vgopt").time||500;p=typeof(p)=="number"?p:s.data("_vgopt").delay||0;if(r>0){m(s.data("_vgchild"),t||s.data("_vgopt").easeing||"linear",r,p)}else{n(s.data("_vgchild"))}if(typeof(q)=="function"){setTimeout(q,s.data("_vgchild").length*p+r)}}return s},vgsort:function(q,t,r,p){var s=h(this);if(s.data("_vgchild")){s.data("_vgchild",s.data("_vgchild").sort(q));s.data("_vgchild").each(function(u){h(this).appendTo(s)});b(s);m(s.data("_vgchild"),t||s.data("_vgopt").easeing||"linear",typeof(r)=="number"?r:s.data("_vgopt").time||500,typeof(p)=="number"?p:s.data("_vgopt").delay||0)}return s},vgdestroy:function(){var p=h(this);h(window).unbind("resize",p.data("_vgresizehandler"));clearTimeout("_vgwraptimeout")}})})(jQuery);