function contentAutocompleteLoader(a){a.fn.contentAutocomplete=function(b){var c={prefix:"content_auto",loaded:function(){},contentAdded:function(){},contentTypeParam:"contentType",contentIDParam:"content",startingContent:{type:-1,id:-1,html:""},contentTypes:[],containerType:-1,container:-1,minInputLength:3,urls:{contentAutocomplete:_jive_base_url+"/content-autocomplete.jspa"},i18nKeys:{change:"Change"}};var d=a.extend(c,b);return this.each(function(){var p=a(this);var s=a('<input type="hidden" name="'+d.contentTypeParam+'" value="'+d.startingContent.type+'"/>');var v=a('<input type="hidden" name="'+d.contentIDParam+'" value="'+d.startingContent.id+'"/>');var f=a('<div class="jive-chooser-autocomplete j-result-list j-rc4"></div>').hide();var w=a('<ul class="jive-chooser-list j-content-list clearfix"></ul>').hide();if(d.startingContent.html.length>0){p.val("").hide().prop("disabled",true);w.html(d.startingContent.html)}p.before(v).before(s);p.after(w).after(f);var t=false;var q=0;var e;var n=function(y){switch(y.keyCode){case a.keyCode.UP:r(q-1);return false;case a.keyCode.DOWN:r(q+1);return false;case a.keyCode.ENTER:u();a.stop(y,true,true);if(q>0){j()}return false;case a.keyCode.ESCAPE:i();return false;case a.keyCode.LEFT:case a.keyCode.RIGHT:case a.keyCode.TAB:case a.keyCode.HOME:case a.keyCode.END:case a.keyCode.PAGE_UP:case a.keyCode.PAGE_DOWN:return false}u();e=setTimeout(function(){k()},400)};var g=function(){t=true;setTimeout(function(){k()},250)};var m=function(){return false;t=false;setTimeout(function(){i()},250)};var k=function(){var y=$j.ajaxSettings.traditional;$j.ajaxSettings.traditional=true;t=true;var z=p.val();if(z.length>=d.minInputLength){z=z+"*";f.load(d.urls.contentAutocomplete,{query:z,contentTypes:d.contentTypes,containerType:d.containerType,container:d.container},o)}else{if(z.length==0){f.load(d.urls.contentAutocomplete,{contentTypes:d.contentTypes,containerType:d.containerType,container:d.container},o)}else{i()}}q=0;$j.ajaxSettings.traditional=y};var o=function(){if(f.html()!=""){var z=(p.offset().top-p.offsetParent().offset().top)+p.outerHeight();var y=p.offset().left-p.offsetParent().offset().left;f.css({top:z,left:y});if(p.width()>200){f.width(p.width())}f.find(".content-autocomplete-item").mouseover(function(){a(this).addClass("hover")});f.find(".content-autocomplete-item").mouseout(function(){a(this).removeClass("hover")});f.find(".content-autocomplete-item A").click(l);f.show();r(1)}};var r=function(y){if(y>0){var z=f.find("#content-autocomplete-index_"+y).addClass("hover").get(0);if(z){f.find("ul li.hover:not(#content-autocomplete-index_"+y+")").removeClass("hover");q=y}}else{f.find("ul li.hover").removeClass("hover");q=0}};var l=function(y){q=a(this).parent().attr("id").split("_")[1];j();y.stopPropagation();return false};var j=function(){var A=f.find("#content-autocomplete-index_"+q)[0];if(A&&a(A).children("a")[0]){var y=a(a(A).children("a")[0]);var z={type:y.attr("id").split("_")[1],id:y.attr("id").split("_")[2],html:y.html()};x(z);p.val("");f.html("").hide()}};var x=function(z){s.val(z.type);v.val(z.id);p.hide().prop("disabled",true);var y=a('<li class="content-autocomplete-selection clearfix content-autocomplete-selection_'+z.type+"_"+z.id+'"></li>');y.append(a(z.html).clone()).append('<span><em>(<a href="#" class="content-autocomplete-remove">'+d.i18nKeys.change+"</a>)</em></span>");w.html(y);w.find(".content-autocomplete-remove").click(h);w.show();d.contentAdded(z)};var h=function(y){w.html("").hide();p.prop("disabled",false).show();s.val("");v.val("");y.stopPropagation();p.focus();return false};var i=function(){if(!t){f.html("").hide()}};var u=function(){if(e){clearTimeout(e)}};if(d.startingContent.html!=""){x(d.startingContent)}p.keydown(function(y){if(y.keyCode==a.ui.keyCode.ENTER){a.stop(y,true,true)}}).keyup(n);p.blur(m);p.focus(g);d.loaded()})}}contentAutocompleteLoader(jQuery);