(function(b){function a(f){var h=b.extend({},a.defaults,f),i=this,e=h.decoration||i;i.bind("close",c);i.delegate(h.closeSelector,"click",c);b(window).keyup(g);function c(j){b(".popover-iframe-interceptor").remove();i.unbind("close",c);i.undelegate(h.closeSelector,"click",c);b(h.closeOnClickSelector).unbind("click",d);b(window).unbind("keyup",g);if(!j||j.type!="close"){i.trigger("close")}if(j&&j.type=="close"){j.stopPropagation()}if(j&&j.type=="click"){j.preventDefault()}return h.onClose.call(this,j)}function d(j){var k=b(j.target).closest(e).length>0;var l=b(j.target).is(h.closeOnClickSelector)||b(j.target).parents(h.closeOnClickSelector).length>0;if(!k&&l){i.trigger("close")}}function g(j){if((j.keyCode==27||(j.DOM_VK_ESCAPE==27&&j.which===0))&&h.closeEsc){i.trigger("close")}}if(h.closeOnClick){setTimeout(function(){if(h.clickOverlay){b("iframe:visible").each(function(){var l=b(this);var j=l.position();var k={position:"absolute",padding:"0",marign:"0","z-index":"990",top:j.top+"px",left:j.left+"px",width:l.outerWidth()+"px",height:l.outerHeight()+"px"};b("<div/>").addClass("popover-iframe-interceptor").css(k).insertAfter(l)})}b(h.closeOnClickSelector).click(d)},0)}}a.defaults={clickOverlay:true,closeEsc:true,closeOnClick:true,closeOnClickSelector:"body",closeSelector:".close",decoration:null,onClose:b.noop};b.fn.autoclose=a})(jQuery);