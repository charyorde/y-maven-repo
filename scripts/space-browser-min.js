jive.gui.SpaceBrowserGui=function(g,l,n,e,k,p,c,v){var f=this;var w=$j("#jive-space-slider_"+l);var y=w.find(".jive-spaces-container");var b;var h=jive.rest.url("/places/search/");v.addListener(f);function m(z){var A=25.25;var C=0.5;var B=A+(z.width()*C);w.scrollTo(z,B);b=z}function j(){w.scrollTo(0);b=null}$j(".space-browser-spaces-tree div.jive-accordion-content").show();if(k=="small"){$j(".space-browser-spaces-search h4").addClass("jive-accordion-toggle-active");$j(".space-browser-spaces-search").show()}$j("#jive-accordion-container_"+l).each(function(){$j(this).find(".jive-accordion h4").click(function(){if($j(this).hasClass("jive-accordion-toggle-active")){if($j(this).parents(".jive-icon-spaces-spaces")){j()}}});$j(this).find(".jive-accordion-content").find(".space-browser-scrollable_"+l).scroll(function(){f.scroller($j(this))})});var t=function(){$j("#container-search-input_"+l).val("");$j("#space-browser-search-results_"+l).hide();w.show();if(k=="large"){$j("#content-block-title").html(n.get("global.communities"));$j("#content-block-search-clear").prop("disabled",true)}return false};var q=function(){var z=$j("#container-search-input_"+l).val();if(z.length>1){w.hide();$j("#jive-search-loading_"+l).show();$j("#space-browser-search-results_"+l).hide();var A={allowedContainerIds:$j("#allowedContainerIds").val(),resultFilterBeanName:$j("#resultFilterBeanName").val(),rootContainerID:$j("#rootContainerID").val(),rootContainerType:$j("#rootContainerType").val(),showDescription:$j("#showDescription").val()};$j.getJSON(h+z,A,function(B){var C=new JiveContainerAutoComplete(z,$j("#resultFilterBeanName").val(),$j("#allowedContainerIds").val(),$j("#rootContainerID").val(),$j("#rootContainerType").val(),"#places_search_"+l,"","false",n.get("widget.places.noresults.text"));C.clearPlaces();C.loadExternalPlaces(B);$j("#jive-search-loading_"+l).hide();$j("#space-browser-search-results_"+l).show();if(k=="large"){$j("#content-block-title").html(n.get("global.search.results"));$j("#content-block-search-clear").prop("disabled",false)}})}if(z.length<1){t()}};$j("#container-search-input_"+l).delayedObserver(q,0.5);$j("#container-search-input_"+l).keypress(function(A){var z=A.which||A.keyCode;if(z===jive.Event.KEY_RETURN){q();A.preventDefault()}});$j("#clearsearch_"+l).click(t);if(k=="large"){$j("#content-block-search-clear").click(t)}w.width(w.parent().width());y.children().width(w.width());$j(window).bind("resize",function(){if(w.parent().length>0){w.width(w.parent().width());y.children().width(w.width());if(b){w.scrollTo(b)}}});this.loadPlaces=function(z){if("COMMUNITY"!=z.name){return}f.populateContainers(z)};this.beginLoadingPlaces=function(){};this.doneLoadingPlaces=function(C,D){var z=v.getPlaces(C.type);var A=z.slice(D,z.length);var B;if(C.communityID<=1||C.communityID==c){B=$j("#COMMUNITY_list_"+l);f.populateSpaces(A,B)}else{B=$j("#places-spaces-list_"+l+"_"+C.communityID);f.populateSpaces(A,B)}if(C.slide&&C.widgetID==l){m(B.closest("div"))}};this.loadingPlacesFailed=function(){};this.populateContainers=function i(A){var z=v.getPlaces(A);if(!z||z.length===0){$j("#COMMUNITY_list_"+l).append('<li><p class="empty">'+n.get(A.name)+"</p></li>")}else{f.populateSpaces(v.getPlaces(A),$j("#COMMUNITY_list_"+l))}};function s(){var A=y.width(),z=w.width(),B=(y.children().length+1)*z;if(B>=A){y.width(B*2)}}function o(D,B){D.nextAll().remove();s();var E=$j("<div class='jive-slider-sub' id='slider-sub_"+l+"_"+B.ID+"'></div>");E.width(w.width());y.append(E);var z;z=$j("<span class='jive-space-current'><strong>"+B.name+"</strong></span>");var A=$j("<a href='#' class='jive-slider-link jive-slider-link-back'><span class='jive-icon-med jive-icon-arrow-left'></span>"+n.get("community.list.spaces.navigate.back")+"</a>");A.attr("title",n.get("community.list.spaces.navigate.back"));A.click(function(){m(E.prev());return false});z.append(A);E.append(z);var C=$j("<ul id='places-spaces-list_"+l+"_"+B.ID+"' class='j-place-list clearfix'></ul>");E.append(C);C.scroll(function(){f.scroller($j(this))});v.morePlaces({type:B.type,page:0,communityID:B.ID,parentID:B.parentID,slide:true,widgetID:l})}this.populateSpaces=function a(z,C){var F,A,E,B,G;for(F=0;F<z.length;F++){A=z[F];if(C.find("#place-space-list-entry_"+l+"_"+A.ID).length>0){return false}E=$j("<li id='place-space-list-entry_"+l+"_"+A.ID+"' class='place-space-list-entry clearfix'></li>");E.append(f.createObjectLink(A));if(A.parent=="true"||A.parent===true){B=n.get("communities.view.subspaces");var D=n.get("your.places.subspaces.message");var G=$j("<a href='#' class='jive-slider-link' id='jive-slider-link_"+A.id+"' title='"+D+" "+A.name+"'>"+B+"<span class='jive-icon-med jive-icon-arrow-right'></span></a>");G.bind("click",A,function(I){var H=I.data;var J=w.find("#slider-sub_"+l+"_"+H.ID);if(J.length>0){m(J);return false}else{o(C.parent(),H);return false}});E.append(G)}C.append(E);if(k=="large"){C.removeClass("j-striped");C.find("li:even").addClass("j-striped")}}};this.addListEntries=function d(z,B){for(var D=0;D<z.length;D++){var A=z[D];var C=$j("<li></li>");C.append(f.createObjectLink(A));B.append(C)}};this.createObjectLink=function r(A){var z;if(A.disabledPlace=="true"){z=$j("<span/>")}else{if(A.viewableByUser){var B=p=="true"?"jivecontainerTT-hover-container":"";var E=k=="large"?" no-underline":"";if(A.onClickJs&&A.onClickJs.length>0){z=$j("<a href='#' class='"+B+E+"' onclick='"+A.onClickJs+"'); return false;'></a>")}else{z=$j("<a href='"+A.objectURL+"' class='"+B+E+"'></a>")}}else{z=$j("<span class='jive-places-unauthorized'/>");z.attr("title",n.get("community.list.spaces.unauthorized.tooltip"))}}var D=$j("<span class='jive-places-name'/>");D.text(A.name);var F=$j("<span class='jive-icon-med "+A.iconCssClass+"'></span>");z.append(F);z.append(D);if(p=="true"&&A.viewableByUser){z.bind("mouseover",function(){quickcontainersummary.getContainerTooltip(A.ID,A.objectType)});z.mouseout(function(){quickcontainersummary.cancelTooltip()})}if(k=="large"&&A.description!=null){var C=$j("<span/>",{"class":"font-color-meta-light"}).text(A.description);return $j.merge(z,C)}else{return z}};this.scroller=function u(B){if(B[0].scrollHeight-B.scrollTop()==B.outerHeight()){var D=B.find("li").length;if(D%30===0){var z=B.attr("id");var C=z.split("_")[0];var A=c;if(B.parent().attr("id").match(/^slider-sub_/)){A=B.parent().attr("id").split("_")[2];C="COMMUNITY"}var E=D/30;v.morePlaces({type:{name:C},page:E,communityID:A,parentID:c})}}};this.resetPlaces=function x(z){}};define("jive.gui.SpaceBrowserGui",function(){return jive.gui.SpaceBrowserGui});