/* iepp v2.2 MIT/GPL2 @jon_neal & afarkas */
(function(L,K){function t(d){var c=-1;while(++c<G){d.createElement(H[c])}}if(!window.attachEvent||!K.createStyleSheet||!function(){var b=document.createElement("div");return b.innerHTML="<elem></elem>",b.childNodes.length!==1}()){return}L.iepp=L.iepp||{};var J=L.iepp,I=J.html5elements||"abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|subline|summary|time|video",H=I.split("|"),G=H.length,F=new RegExp("(^|\\s)("+I+")","gi"),E=new RegExp("<(/*)("+I+")","gi"),D=/^\s*[\{\}]\s*$/,C=new RegExp("(^|[^\\n]*?\\s)("+I+")([^\\n]*)({[\\n\\w\\W]*?})","gi"),B=/@media +(?![Print|All])[^{]+\{([^{}]+\{[^{}]+\})+[^}]+\}/g,A=K.createDocumentFragment(),z=K.documentElement,y=K.getElementsByTagName("script")[0].parentNode,x=K.createElement("body"),w=K.createElement("style"),v=/print|all/,u;J.getCSS=function(j,c){try{if(j+""===undefined){return""}}catch(p){return""}var o=-1,n=j.length,m,l,k=[];while(++o<n){m=j[o];if(m.disabled){continue}c=m.media||c,v.test(c)&&(l=m.cssText,c!="print"&&(l=l.replace(B,"")),k.push(J.getCSS(m.imports,c),l)),c="all"}return k.join("")},J.parseCSS=function(e){var d=[],f;while((f=C.exec(e))!=null){d.push(((D.exec(f[1])?"\n":f[1])+f[2]+f[3]).replace(F,"$1.iepp-$2")+f[4])}return d.join("\n")},J.writeHTML=function(){var b=-1;u=u||K.body;while(++b<G){var h=K.getElementsByTagName(H[b]),f=h.length,e=-1;while(++e<f){h[e].className.indexOf("iepp-")<0&&(h[e].className+=" iepp-"+H[b])}}A.appendChild(u),z.appendChild(x),x.className=u.className,x.id=u.id,x.innerHTML=u.innerHTML.replace(E,"<$1font")},J._beforePrint=function(){if(J.disablePP){return}w.styleSheet.cssText=J.parseCSS(J.getCSS(K.styleSheets,"all")),J.writeHTML()},J.restoreHTML=function(){if(J.disablePP){return}x.swapNode(u)},J._afterPrint=function(){J.restoreHTML(),w.styleSheet.cssText=""},t(K),t(A);if(J.disablePP){return}y.insertBefore(w,y.firstChild),w.media="print",w.className="iepp-printshim",L.attachEvent("onbeforeprint",J._beforePrint),L.attachEvent("onafterprint",J._afterPrint)})(this,document);