/* iepp v2.2 MIT/GPL2 @jon_neal & afarkas */
(function(g,s){if(!window.attachEvent||!s.createStyleSheet||!(function(){var t=document.createElement("div");t.innerHTML="<elem></elem>";return t.childNodes.length!==1})()){return}g.iepp=g.iepp||{};var h=g.iepp,r=h.html5elements||"abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|subline|summary|time|video",b=r.split("|"),q=b.length,p=new RegExp("(^|\\s)("+r+")","gi"),o=new RegExp("<(/*)("+r+")","gi"),f=/^\s*[\{\}]\s*$/,a=new RegExp("(^|[^\\n]*?\\s)("+r+")([^\\n]*)({[\\n\\w\\W]*?})","gi"),m=/@media +(?![Print|All])[^{]+\{([^{}]+\{[^{}]+\})+[^}]+\}/g,d=s.createDocumentFragment(),l=s.documentElement,i=s.getElementsByTagName("script")[0].parentNode,j=s.createElement("body"),e=s.createElement("style"),n=/print|all/,k;function c(u){var t=-1;while(++t<q){u.createElement(b[t])}}h.getCSS=function(x,v){try{if(x+""===undefined){return""}}catch(A){return""}var u=-1,t=x.length,z,y,w=[];while(++u<t){z=x[u];if(z.disabled){continue}v=z.media||v;if(n.test(v)){y=z.cssText;if(v!="print"){y=y.replace(m,"")}w.push(h.getCSS(z.imports,v),y)}v="all"}return w.join("")};h.parseCSS=function(u){var t=[],v;while((v=a.exec(u))!=null){t.push(((f.exec(v[1])?"\n":v[1])+v[2]+v[3]).replace(p,"$1.iepp-$2")+v[4])}return t.join("\n")};h.writeHTML=function(){var u=-1;k=k||s.body;while(++u<q){var v=s.getElementsByTagName(b[u]),w=v.length,t=-1;while(++t<w){if(v[t].className.indexOf("iepp-")<0){v[t].className+=" iepp-"+b[u]}}}d.appendChild(k);l.appendChild(j);j.className=k.className;j.id=k.id;j.innerHTML=k.innerHTML.replace(o,"<$1font")};h._beforePrint=function(){if(h.disablePP){return}e.styleSheet.cssText=h.parseCSS(h.getCSS(s.styleSheets,"all"));h.writeHTML()};h.restoreHTML=function(){if(h.disablePP){return}j.swapNode(k)};h._afterPrint=function(){h.restoreHTML();e.styleSheet.cssText=""};c(s);c(d);if(h.disablePP){return}i.insertBefore(e,i.firstChild);e.media="print";e.className="iepp-printshim";g.attachEvent("onbeforeprint",h._beforePrint);g.attachEvent("onafterprint",h._afterPrint)})(this,document);