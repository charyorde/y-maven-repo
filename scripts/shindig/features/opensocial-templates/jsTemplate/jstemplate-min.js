var ATT_select="jsselect";var ATT_instance="jsinstance";var ATT_display="jsdisplay";var ATT_values="jsvalues";var ATT_vars="jsvars";var ATT_eval="jseval";var ATT_transclude="transclude";var ATT_content="jscontent";var ATT_skip="jsskip";var ATT_innerselect="jsinnerselect";var ATT_jstcache="jstcache";var PROP_jstcache="__jstcache";var STRING_jsts="jsts";var CHAR_asterisk="*";var CHAR_dollar="$";var CHAR_period=".";var CHAR_ampersand="&";var STRING_div="div";var STRING_id="id";var STRING_asteriskzero="*0";var STRING_zero="0";function jstProcess(a,d,c){var b=new JstProcessor;if(MAPS_DEBUG&&c){b.setDebugging(c)}JstProcessor.prepareTemplate_(d);b.document_=ownerDocument(d);b.run_(bindFully(b,b.jstProcessOuter_,a,d));if(MAPS_DEBUG&&c){log("jstProcess:\n"+b.getLogs().join("\n"))}}function JstProcessor(){if(MAPS_DEBUG){this.logs_=[]}}JstProcessor.jstid_=0;JstProcessor.jstcache_={};JstProcessor.jstcache_[0]={};JstProcessor.jstcacheattributes_={};JstProcessor.attributeValues_={};JstProcessor.attributeList_=[];JstProcessor.prepareTemplate_=function(a){if(!a[PROP_jstcache]){domTraverseElements(a,function(b){JstProcessor.prepareNode_(b)})}};var JST_ATTRIBUTES=[[ATT_select,jsEvalToFunction],[ATT_display,jsEvalToFunction],[ATT_values,jsEvalToValues],[ATT_vars,jsEvalToValues],[ATT_eval,jsEvalToExpressions],[ATT_transclude,jsEvalToSelf],[ATT_content,jsEvalToFunction],[ATT_skip,jsEvalToFunction],[ATT_innerselect,jsEvalToFunction]];JstProcessor.prepareNode_=function(e){if(e[PROP_jstcache]){return e[PROP_jstcache]}var c=domGetAttribute(e,ATT_jstcache);if(c!=null){return e[PROP_jstcache]=JstProcessor.jstcache_[c]}var m=JstProcessor.attributeValues_;var d=JstProcessor.attributeList_;d.length=0;for(var g=0,l=jsLength(JST_ATTRIBUTES);g<l;++g){var b=JST_ATTRIBUTES[g][0];var k=domGetAttribute(e,b);m[b]=k;if(k!=null){d.push(b+"="+k)}}if(d.length==0){domSetAttribute(e,ATT_jstcache,STRING_zero);return e[PROP_jstcache]=JstProcessor.jstcache_[0]}var j=d.join(CHAR_ampersand);if(c=JstProcessor.jstcacheattributes_[j]){domSetAttribute(e,ATT_jstcache,c);return e[PROP_jstcache]=JstProcessor.jstcache_[c]}var a={};for(var g=0,l=jsLength(JST_ATTRIBUTES);g<l;++g){var h=JST_ATTRIBUTES[g];var b=h[0];var f=h[1];var k=m[b];if(k!=null){a[b]=f(k);if(MAPS_DEBUG){a.jstAttributeValues=a.jstAttributeValues||{};a.jstAttributeValues[b]=k}}}c=STRING_empty+ ++JstProcessor.jstid_;domSetAttribute(e,ATT_jstcache,c);JstProcessor.jstcache_[c]=a;JstProcessor.jstcacheattributes_[j]=c;return e[PROP_jstcache]=a};JstProcessor.prototype.run_=function(g){var i=this;var l=i.calls_=[];var k=i.queueIndices_=[];var e=i.arrayPool_=[];g();var d,h;var a,c,b;var j;while(l.length){d=l[l.length-1];h=k[k.length-1];if(h>=d.length){i.recycleArray_(l.pop());k.pop();continue}a=d[h++];c=d[h++];b=d[h++];k[k.length-1]=h;a.call(i,c,b)}};JstProcessor.prototype.push_=function(a){this.calls_.push(a);this.queueIndices_.push(0)};JstProcessor.prototype.setDebugging=function(a){if(MAPS_DEBUG){this.debugging_=a}};JstProcessor.prototype.createArray_=function(){if(this.arrayPool_.length){return this.arrayPool_.pop()}else{return[]}};JstProcessor.prototype.recycleArray_=function(a){arrayClear(a);this.arrayPool_.push(a)};JstProcessor.prototype.jstProcessOuter_=function(c,e){var f=this;var h=f.jstAttributes_(e);if(MAPS_DEBUG&&f.debugging_){f.logState_("Outer",e,h.jstAttributeValues)}var b=h[ATT_transclude];if(b){var g=jstGetTemplate(b);if(g){domReplaceChild(g,e);var d=f.createArray_();d.push(f.jstProcessOuter_,c,g);f.push_(d)}else{domRemoveNode(e)}return}var a=h[ATT_select];if(a){f.jstSelect_(c,e,a)}else{f.jstProcessInner_(c,e)}};JstProcessor.prototype.jstProcessInner_=function(b,q){var n=this;var h=n.jstAttributes_(q);if(MAPS_DEBUG&&n.debugging_){n.logState_("Inner",q,h.jstAttributeValues)}var l=h[ATT_display];if(l){var a=b.jsexec(l,q);if(MAPS_DEBUG&&n.debugging_){n.logs_.push(ATT_display+": "+a+"<br/>")}if(!a){displayNone(q);return}displayDefault(q)}var r=h[ATT_vars];if(r){n.jstVars_(b,q,r)}r=h[ATT_values];if(r){n.jstValues_(b,q,r)}var j=h[ATT_eval];if(j){for(var f=0,o=jsLength(j);f<o;++f){b.jsexec(j[f],q)}}var p=h[ATT_skip];if(p){var e=b.jsexec(p,q);if(MAPS_DEBUG&&n.debugging_){n.logs_.push(ATT_skip+": "+e+"<br/>")}if(e){return}}var k=h[ATT_content];if(k){n.jstContent_(b,q,k)}else{var g=n.createArray_();var s=null;for(var m=q.firstChild;m;m=m.nextSibling){if(m.nodeType==DOM_ELEMENT_NODE){if(!s){s=b;var d=h[ATT_innerselect];if(d&&d!=VAR_this){s=b.clone(b.jsexec(d,q),0,0)}}g.push(n.jstProcessOuter_,s,m)}}if(g.length){n.push_(g)}}};JstProcessor.prototype.jstSelect_=function(a,p,l){var k=this;var n=a.jsexec(l,p);var q=domGetAttribute(p,ATT_instance);var h=false;if(q){if(q.charAt(0)==CHAR_asterisk){q=parseInt10(q.substr(1));h=true}else{q=parseInt10((q))}}var r=isArray(n);var g=r?jsLength(n):1;var c=(r&&g==0);if(r){if(c){if(!q){domSetAttribute(p,ATT_instance,STRING_asteriskzero);displayNone(p)}else{domRemoveNode(p)}}else{displayDefault(p);if(q===null||q===STRING_empty||(h&&q<g-1)){var e=k.createArray_();var f=q||0;var d,m,j;for(d=f,m=g-1;d<m;++d){var b=domCloneNode(p);domInsertBefore(b,p);jstSetInstance((b),n,d);j=a.clone(n[d],d,g);e.push(k.jstProcessInner_,j,b,JsEvalContext.recycle,j,null)}jstSetInstance(p,n,d);j=a.clone(n[d],d,g);e.push(k.jstProcessInner_,j,p,JsEvalContext.recycle,j,null);k.push_(e)}else{if(q<g){var o=n[q];jstSetInstance(p,n,q);var j=a.clone(o,q,g);var e=k.createArray_();e.push(k.jstProcessInner_,j,p,JsEvalContext.recycle,j,null);k.push_(e)}else{domRemoveNode(p)}}}}else{if(n==null){displayNone(p)}else{displayDefault(p);var j=a.clone(n,0,1);var e=k.createArray_();e.push(k.jstProcessInner_,j,p,JsEvalContext.recycle,j,null);k.push_(e)}}};JstProcessor.prototype.jstVars_=function(e,f,a){for(var d=0,c=jsLength(a);d<c;d+=2){var b=a[d];var g=e.jsexec(a[d+1],f);e.setVariable(b,g)}};JstProcessor.prototype.jstValues_=function(b,n,o){for(var d=0,l=jsLength(o);d<l;d+=2){var h=o[d];var k=b.jsexec(o[d+1],n);if(h.charAt(0)==CHAR_dollar){b.setVariable(h,k)}else{if(h.charAt(0)==CHAR_period){var m=h.substr(1).split(CHAR_period);var f=n;var e=jsLength(m);for(var c=0,g=e-1;c<g;++c){var a=m[c];if(!f[a]){f[a]={}}f=f[a]}f[m[e-1]]=k}else{if(h){if(typeof k==TYPE_boolean){if(k){domSetAttribute(n,h,h)}else{domRemoveAttribute(n,h)}}else{domSetAttribute(n,h,STRING_empty+k)}}}}}};JstProcessor.prototype.jstContent_=function(b,c,d){var e=STRING_empty+b.jsexec(d,c);if(c.innerHTML==e){return}while(c.firstChild){domRemoveNode(c.firstChild)}var a=domCreateTextNode(this.document_,e);domAppendChild(c,a)};JstProcessor.prototype.jstAttributes_=function(b){if(b[PROP_jstcache]){return b[PROP_jstcache]}var a=domGetAttribute(b,ATT_jstcache);if(a){return b[PROP_jstcache]=JstProcessor.jstcache_[a]}return JstProcessor.prepareNode_(b)};function jstGetTemplate(b,e){var d=document;var c;if(e){c=jstLoadTemplateIfNotPresent(d,b,e)}else{c=domGetElementById(d,b)}if(c){JstProcessor.prepareTemplate_(c);var a=domCloneElement(c);domRemoveAttribute(a,STRING_id);return a}else{return null}}function jstGetTemplateOrDie(b,c){var a=jstGetTemplate(b,c);return(a)}function jstLoadTemplateIfNotPresent(d,a,e,b){var c=domGetElementById(d,a);if(c){return c}jstLoadTemplate_(d,e(),b||STRING_jsts);var c=domGetElementById(d,a);if(!c){log("Error: jstGetTemplate was provided with opt_loadHtmlFn, but that function did not provide the id '"+a+"'.")}return(c)}function jstLoadTemplate_(d,b,a){var e=domGetElementById(d,a);var c;if(!e){c=domCreateElement(d,STRING_div);c.id=a;displayNone(c);positionAbsolute(c);domAppendChild(d.body,c)}else{c=e}var f=domCreateElement(d,STRING_div);c.appendChild(f);f.innerHTML=b}function jstSetInstance(c,a,b){if(b==jsLength(a)-1){domSetAttribute(c,ATT_instance,CHAR_asterisk+b)}else{domSetAttribute(c,ATT_instance,STRING_empty+b)}}JstProcessor.prototype.logState_=function(a,b,c){if(MAPS_DEBUG){var d="<table>";d+="<caption>"+a+"</caption>";d+="<tbody>";if(b.id){d+="<tr><td>id:</td><td>"+b.id+"</td></tr>"}if(b.name){d+="<tr><td>name:</td><td>"+b.name+"</td></tr>"}if(c){d+="<tr><td>attr:</td><td>"+(c)+"</td></tr>"}d+="</tbody></table><br/>";this.logs_.push(d)}};JstProcessor.prototype.getLogs=function(){return this.logs_};