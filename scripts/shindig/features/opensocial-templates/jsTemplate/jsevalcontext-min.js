var VAR_index="Index";var VAR_count="Count";var VAR_this="$this";var VAR_context="$context";var VAR_top="$top";var VAR_loop="$loop";var GLOB_default="$default";var CHAR_colon=":";var REGEXP_semicolon=/\s*;\s*/;function JsEvalContext(a,b){this.constructor_.apply(this,arguments)}JsEvalContext.prototype.constructor_=function(a,b){var c=this;if(!c.vars_){c.vars_={}}if(b){copyProperties(c.vars_,b.vars_)}else{copyProperties(c.vars_,JsEvalContext.globals_)}c.vars_[VAR_this]=a;c.vars_[VAR_context]=c;c.data_=getDefaultObject(a,STRING_empty);if(!b){c.vars_[VAR_top]=c.data_}};JsEvalContext.globals_={};JsEvalContext.setGlobal=function(a,b){JsEvalContext.globals_[a]=b};JsEvalContext.setGlobal(GLOB_default,null);JsEvalContext.recycledInstances_=[];JsEvalContext.create=function(b,c){if(jsLength(JsEvalContext.recycledInstances_)>0){var a=JsEvalContext.recycledInstances_.pop();JsEvalContext.call(a,b,c);return a}else{return new JsEvalContext(b,c)}};JsEvalContext.recycle=function(a){for(var b in a.vars_){delete a.vars_[b]}a.data_=null;JsEvalContext.recycledInstances_.push(a)};JsEvalContext.prototype.jsexec=function(b,a){try{return b.call(a,this.vars_,this.data_)}catch(c){log("jsexec EXCEPTION: "+c+" at "+a+" with "+b);return JsEvalContext.globals_[GLOB_default]}};JsEvalContext.prototype.clone=function(e,b,d){var a=JsEvalContext.create(e,this);if(typeof(b)=="number"||typeof(d)=="number"){var c={};c[VAR_index]=b;c[VAR_count]=d;a.setVariable(VAR_loop,c)}return a};JsEvalContext.prototype.setVariable=function(a,b){this.vars_[a]=b};JsEvalContext.prototype.getVariable=function(a){return this.vars_[a]};JsEvalContext.prototype.evalExpression=function(c,b){var a=jsEvalToFunction(c);return this.jsexec(a,b)};var STRING_a="a_";var STRING_b="b_";var STRING_with="with (a_) with (b_) return ";JsEvalContext.evalToFunctionCache_={};function jsEvalToFunction(b){if(!JsEvalContext.evalToFunctionCache_[b]){try{JsEvalContext.evalToFunctionCache_[b]=new Function(STRING_a,STRING_b,STRING_with+b)}catch(a){log("jsEvalToFunction ("+b+") EXCEPTION "+a)}}return JsEvalContext.evalToFunctionCache_[b]}function jsEvalToSelf(a){return a}function jsEvalToValues(h){var d=[];var a=h.split(REGEXP_semicolon);for(var e=0,c=jsLength(a);e<c;++e){var f=a[e].indexOf(CHAR_colon);if(f<0){continue}var b=stringTrim(a[e].substr(0,f));var g=jsEvalToFunction(a[e].substr(f+1));d.push(b,g)}return d}function jsEvalToExpressions(f){var c=[];var a=f.split(REGEXP_semicolon);for(var d=0,b=jsLength(a);d<b;++d){if(a[d]){var e=jsEvalToFunction(a[d]);c.push(e)}}return c};