os.Loader={};os.Loader.loadedUrls_={};os.Loader.loadUrl=function(a,b){if(typeof(window.gadgets)!="undefined"){os.Loader.requestUrlGadgets_(a,b)}else{os.Loader.requestUrlXHR_(a,b)}};os.Loader.requestUrlXHR_=function(a,c){if(os.Loader.loadedUrls_[a]){window.setTimeout(c,0);return}var b=null;if(typeof shindig!="undefined"&&shindig.xhrwrapper&&shindig.xhrwrapper.createXHR){b=shindig.xhrwrapper.createXHR()}else{if(typeof XMLHttpRequest!="undefined"){b=new XMLHttpRequest()}else{b=new ActiveXObject("MSXML2.XMLHTTP")}}b.open("GET",a,true);b.onreadystatechange=function(){if(b.readyState==4){os.Loader.loadContent(b.responseText,a);c()}};b.send(null)};os.Loader.requestUrlGadgets_=function(b,d){var c={};var a=window.gadgets;if(os.Loader.loadedUrls_[b]){window.setTimeout(d,0);return}c[a.io.RequestParameters.CONTENT_TYPE]=a.io.ContentType.TEXT;a.io.makeRequest(b,function(e){os.Loader.loadContent(e.data,b);d()},c)};os.Loader.loadUrls=function(b,c){var a=function(){if(b.length==0){c()}else{os.Loader.loadUrl(b.pop(),a)}};a()};os.Loader.loadContent=function(d,a){var c=gadgets.jsondom.parse(d,a);var b=c.firstChild;os.Loader.processTemplatesNode(b);os.Loader.loadedUrls_[a]=true};os.Loader.getProcessorFunction_=function(a){return os.Loader["process"+a+"Node"]||null};os.Loader.processTemplatesNode=function(b){if(b.firstChild){b=b.firstChild}for(var c=b;c;c=c.nextSibling){if(c.nodeType==DOM_ELEMENT_NODE){var a=os.Loader.getProcessorFunction_(c.tagName);if(a){a(c)}}}};os.Loader.processNamespaceNode=function(b){var c=b.getAttribute("prefix");var a=b.getAttribute("url");os.createNamespace(c,a)};os.Loader.processTemplateDefNode=function(d){var a=d.getAttribute("tag");var b=d.getAttribute("name");for(var e=d.firstChild;e;e=e.nextSibling){if(e.nodeType==DOM_ELEMENT_NODE){var c=os.Loader.getProcessorFunction_(e.tagName);if(c){c(e,a,b)}}}};os.Loader.processTemplateNode=function(f,h,g){var c=h||f.getAttribute("tag");var d=g||f.getAttribute("name");if(c){var b=c.split(":");if(b.length!=2){throw Error("Invalid tag name: "+c)}var a=os.getNamespace(b[0]);if(!a){throw Error("Namespace not registered: "+b[0]+" while trying to define "+c)}var e=os.compileXMLNode(f);a[b[1]]=os.createTemplateCustomTag(e)}else{if(d){var e=os.compileXMLNode(f);e.id=d;os.registerTemplate(e)}}};os.Loader.processJavaScriptNode=function(b,c){for(var a=b.firstChild;a;a=a.nextSibling){os.Loader.injectJavaScript(a.nodeValue)}};os.Loader.processStyleNode=function(b,c){for(var a=b.firstChild;a;a=a.nextSibling){os.Loader.injectStyle(a.nodeValue)}};os.Loader.headNode_=document.getElementsByTagName("head")[0]||document.getElementsByTagName("*")[0];os.Loader.injectJavaScript=function(b){var a=document.createElement("script");a.type="text/javascript";a.text=b;os.Loader.headNode_.appendChild(a)};os.Loader.injectStyle=function(b){var d;if(document.styleSheets.length==0){document.getElementsByTagName("head")[0].appendChild(document.createElement("style"))}d=document.styleSheets[0];var g=b.split("}");for(var c=0;c<g.length;c++){var f=g[c].replace(/\n/g,"").replace(/\s+/g," ");try{if(f.length>2){if(d.insertRule){f=f+"}";d.insertRule(f,d.cssRules.length)}else{var a=f.split("{");d.addRule(a[0],a[1])}}}catch(e){gadgets.error("Error in stylesheet: "+f+" - "+e.name+" - "+e.message)}}};