gadgets.rpctx=gadgets.rpctx||{};if(!gadgets.rpctx.nix){gadgets.rpctx.nix=function(){var c="GRPC____NIXVBS_wrapper";var d="GRPC____NIXVBS_get_wrapper";var f="GRPC____NIXVBS_handle_message";var b="GRPC____NIXVBS_create_channel";var a=10;var j=500;var i={};var h;var g=0;function e(){var l=i[".."];if(l){return}if(++g>a){gadgets.warn("Nix transport setup failed, falling back...");h("..",false);return}if(!l&&window.opener&&"GetAuthToken" in window.opener){l=window.opener;if(l.GetAuthToken()==gadgets.rpc.getAuthToken("..")){var k=gadgets.rpc.getAuthToken("..");l.CreateChannel(window[d]("..",k),k);i[".."]=l;window.opener=null;h("..",true);return}}window.setTimeout(function(){e()},j)}return{getCode:function(){return"nix"},isParentVerifiable:function(){return false},init:function(l,m){h=m;if(typeof window[d]!=="unknown"){window[f]=function(o){window.setTimeout(function(){l(gadgets.json.parse(o))},0)};window[b]=function(o,q,p){if(gadgets.rpc.getAuthToken(o)===p){i[o]=q;h(o,true)}};var k="Class "+c+"\n Private m_Intended\nPrivate m_Auth\nPublic Sub SetIntendedName(name)\n If isEmpty(m_Intended) Then\nm_Intended = name\nEnd If\nEnd Sub\nPublic Sub SetAuth(auth)\n If isEmpty(m_Auth) Then\nm_Auth = auth\nEnd If\nEnd Sub\nPublic Sub SendMessage(data)\n "+f+"(data)\nEnd Sub\nPublic Function GetAuthToken()\n GetAuthToken = m_Auth\nEnd Function\nPublic Sub CreateChannel(channel, auth)\n Call "+b+"(m_Intended, channel, auth)\nEnd Sub\nEnd Class\nFunction "+d+"(name, auth)\nDim wrap\nSet wrap = New "+c+"\nwrap.SetIntendedName name\nwrap.SetAuth auth\nSet "+d+" = wrap\nEnd Function";try{window.execScript(k,"vbscript")}catch(n){return false}}return true},setup:function(o,k){if(o===".."){e();return true}try{var m=document.getElementById(o);var n=window[d](o,k);m.contentWindow.opener=n}catch(l){return false}return true},call:function(k,n,m){try{if(i[k]){i[k].SendMessage(gadgets.json.stringify(m))}}catch(l){return false}return true}}}()};