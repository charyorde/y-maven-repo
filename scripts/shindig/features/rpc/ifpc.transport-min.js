gadgets.rpctx=gadgets.rpctx||{};if(!gadgets.rpctx.ifpc){gadgets.rpctx.ifpc=function(){var h=[];var e=0;var d;var a=2000;var g={};function c(m){var k=[];for(var n=0,l=m.length;n<l;++n){k.push(encodeURIComponent(gadgets.json.stringify(m[n])))}return k.join("&")}function b(m){var k;for(var j=h.length-1;j>=0;--j){var n=h[j];try{if(n&&(n.recyclable||n.readyState==="complete")){n.parentNode.removeChild(n);if(window.ActiveXObject){h[j]=n=null;h.splice(j,1)}else{n.recyclable=false;k=n;break}}}catch(l){}}if(!k){k=document.createElement("iframe");k.style.border=k.style.width=k.style.height="0px";k.style.visibility="hidden";k.style.position="absolute";k.onload=function(){this.recyclable=true};h.push(k)}k.src=m;window.setTimeout(function(){document.body.appendChild(k)},0)}function f(j,l){for(var k=l-1;k>=0;--k){if(typeof j[k]==="undefined"){return false}}return true}return{getCode:function(){return"ifpc"},isParentVerifiable:function(){return true},init:function(i,j){d=j;d("..",true);return true},setup:function(j,i){d(j,true);return true},call:function(s,r,q){var l=gadgets.rpc.getRelayUrl(s);++e;if(!l){gadgets.warn("No relay file assigned for IFPC");return false}var i=null,j=[];if(q.l){var o=q.a;i=[l,"#",c([r,e,1,0,c([r,q.s,"","",r].concat(o))])].join("");j.push(i)}else{i=[l,"#",s,"&",r,"@",e,"&"].join("");var t=encodeURIComponent(gadgets.json.stringify(q)),n=a-i.length,p=Math.ceil(t.length/n),m=0,k;while(t.length>0){k=t.substring(0,n);t=t.substring(n);j.push([i,p,"&",m,"&",k].join(""));m+=1}}do{b(j.shift())}while(j.length>0);return true},_receiveMessage:function(i,n){var o=i[1],m=parseInt(i[2],10),k=parseInt(i[3],10),l=i[i.length-1],j=m===1;if(m>1){if(!g[o]){g[o]=[]}g[o][k]=l;if(f(g[o],m)){l=g[o].join("");delete g[o];j=true}}if(j){n(gadgets.json.parse(decodeURIComponent(l)))}}}}()};