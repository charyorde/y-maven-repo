jive.namespace("ActivityStream");jive.ActivityStream.CreateMenuView=jive.oo.Class.extend(function(a){this.init=function(c){var b=this;b.createMenuData=c.createMenuData};this.postRender=function(){var b=this;b.quickUrl="#";b.quickCreateSource=new jive.Navbar.Menu.Create.QuickCreateSource();b.quickCreateView=new jive.Navbar.Menu.Create.QuickCreateView();b.quickCreateView.addListener("fetch",function(c){b.quickCreateSource.fetch(b.quickUrl,c)});b.$upMenu=$j("#j-as-create-menu-items");b.$downMenu=$j("#j-as-create-menu-pop");b.$menuItems=b.$upMenu.find(".j-as-create-item");b.$moreBtn=$j("#as-create-menu-more");b.$upMenu.off().on("click","a.quick",b.handleQuickCreate.bind(b));b.$downMenu.off().on("click","a.quick",b.handleQuickCreate.bind(b));b.$moreBtn.off().on("click",b.showDownMenu.bind(b));$j(window).resize(b.handleResize.bind(b))};this.handleQuickCreate=function(d){var b=this,c=$j(d.target),f=c.attr("data-content-type");b.$downMenu.trigger("close");if(jive.DirectMessaging.isContentTypeEqualTo(f)){jive.DirectMessaging.create({trackingID:"cmenu"}).showModal()}else{b.quickUrl=c.data("quick-create-url");b.quickCreateView.render()}d.preventDefault()};this.showDownMenu=function(j){var f=this,k=$j(j.target),c=f.$upMenu.outerWidth(),m=0,l=[],d=[],h=f.createMenuData.sections[0].items;j.preventDefault();f.$menuItems.each(function(){var e=$j(this);m+=e.outerWidth();if(m>c){l.push(e.data("ident"))}});for(var g=0,b=h.length;g<b;g++){if($j.inArray(h[g].nameKey,l)!=-1){d.push(h[g])}}f.$downMenu.html(jive.home.activityStreamCreateMenuPopover({menuItems:d}));f.$downMenu.popover({context:k,destroyOnClose:false,putBack:true})};this.handleResize=function(){var b=this,d=b.$upMenu.outerWidth(true),c=0;b.$menuItems.each(function(){c+=$j(this).outerWidth(true)});if(d>=c-1){b.$moreBtn.hide()}else{b.$moreBtn.show()}}});