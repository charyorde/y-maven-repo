jive.namespace("Placepicker");jive.Placepicker.Main=jive.oo.Class.extend(function(a){jive.conc.observable(this);a.init=function(c){var b=this;this.pickerContext=c.pickerContext||"create";this.objectType=c.objectType;this.objectID=c.objectID||-1;this.upload=c.upload;this.personalContainerTitleKey=c.personalContainerTitleKey;this.personalContainerCaptionKey=c.personalContainerCaptionKey;this.searchPlaceholderKey=c.searchPlaceholderKey;this.containerType=c.containerType;this.containerID=c.containerID;this.filterGroup=c.filterGroup;this.followLinks=c.followLinks||false;this.parent=c.parent||null;this.closeOnSelect=c.closeOnSelect||false;this.filterByContainer=c.filterByContainer||false;this.hideUserContainer=c.hideUserContainer||false;this.fromQuest=c.fromQuest;this.containers=new jive.Placepicker.SearchContainersSource();this.browseContainers=new jive.Placepicker.BrowseContainersSource();this.placePicker=new jive.Placepicker.PlacePickerSource(this.pickerContext,{containerType:this.containerType,containerID:this.containerID});this.containerBrowseView=new jive.Placepicker.ContainerBrowseView({filterGroup:this.filterGroup,parent:this.parent,followLinks:this.followLinks,closeOnSelect:this.closeOnSelect,hideUserContainer:this.hideUserContainer});this.containerBrowseView.addListener("browseLoad",function(d,f){var e=jQuery.extend({contentType:b.objectType,contentID:b.objectID},d);if(b.filterByContainer){e=jQuery.extend({},{containerType:b.containerType,containerID:b.containerID},e)}b.browseContainers.findAll(e).addCallback(function(g){f.emitSuccess({contentType:b.objectType,containerType:b.containerType,containerID:b.containerID,upload:b.upload,containers:g.items,containerName:g.containerName,parentName:g.parentName})})});this.containerBrowseView.addListener("search",function(d,e){b.containers.findAll({query:d,contentType:b.objectType,contentID:b.objectID}).addCallback(function(f){e.emitSuccess(jQuery.extend({contentType:b.objectType,containerType:b.containerType,containerID:b.containerID,upload:b.upload},f))})});this.containerBrowseView.addListener("container",function(d){b.emit("container",d)})};this.showPicker=function(){var b=this;b.placePicker.findAll({contentType:b.objectType,contentID:b.objectID}).addCallback(function(c){b.containerBrowseView.render(jQuery.extend({contentID:b.contentID,contentType:b.objectType,containerType:b.containerType,containerID:b.containerID,hideUserContainer:b.hideUserContainer,selectedContentType:{id:b.objectType,personalContainerTitleKey:b.personalContainerTitleKey,personalContainerCaptionKey:b.personalContainerCaptionKey,searchPlaceholderKey:b.searchPlaceholderKey}},c))})}});