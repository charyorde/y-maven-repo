jive.namespace("UserPrefs.Mobile");jive.UserPrefs.Mobile.Main=jive.oo.Class.extend(function(a){var b=new jive.UserPrefs.Mobile.OAuthPairing("mobile-client");a.init=function(){var f=new jive.UserPrefs.Mobile.FirstVisit("#js-first-visit");var g=new jive.UserPrefs.Mobile.PairingList("#pending_pairings");var h=new jive.UserPrefs.Mobile.PairingList("#active_pairings");var d=new jive.UserPrefs.Mobile.GenerateForm("#generate_pairing");var c=this;f.addListener("close",function(){f.hide();d.showForm();b.markFirstVisit()});g.addListener("remove",i(g));g.addListener("show-activation-popup",function(j){b.get(j).addCallback(function(k){e(k)})});h.addListener("remove",i(h));h.addListener("renew",function(j){b.renew(j).addCallback(function(k){h.removeRow(j);g.addNew(k);e(k)})});function i(j){return function(m){var l=new jive.UserPrefs.Mobile.RemoveConfirmation(m);l.addListener("confirm",function(){l.getContent().trigger("close");b.destroy(m).addCallback(function(){j.removeRow(m)})});var k={closeSelector:".close",destroyOnClose:true};l.getContent().lightbox_me(k)}}d.addListener("create",function(j){(b.validate(j)).addErrback(function(k){d.handleError(k)}).addCallback(function(){b.save(j).addCallback(function(k){g.addNew(k);d.resetForm();e(k)}).addErrback(function(l,k){d.handleError([{message:l,code:k}])})})});function e(l){var j=new jive.UserPrefs.Mobile.ActivateModal(l,c.mobileURL,c.communityName);var k={closeSelector:".close",destroyOnClose:true};j.getContent().lightbox_me(k)}};this.setMobileURL=function(c){this.mobileURL=c};this.setCommunityName=function(c){this.communityName=c}});