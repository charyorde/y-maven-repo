jive.namespace("RecommendationApp").GeneralRecommendationController=function(d,k,i){var l={},e=new jive.RecommendationApp.Controller(k),f=null,g=e.getBody,b=g().attr("data-load-more")==="true",h=parseInt(g().attr("data-max"));function j(){d.getTrendingContentHome(h*2).addCallback(function(m){b=false;g("[data-event=loadMore]").remove();e.removeListener("loadMore",j);a(m.recommendations)})}function c(m){if(b&&m.length<=h){b=false}else{if(m.length>h){m=m.slice(0,h)}}a(m)}function a(m){if(e.shouldUpdate(m,f,true)){m.currentUserPartner=window._jive_current_user.partner;f=m;var n={recommendations:m};b&&(n.canLoadMore=m.length===h);g().html(i(n))}}l.isPopulated=function(){return(f||[]).length>0};l.notify=function(m){if(m==="newRecommendations"){c(arguments[1])}};e.addListener("loadMore",j);return l};