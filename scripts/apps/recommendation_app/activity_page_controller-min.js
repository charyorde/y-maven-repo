jive.namespace("RecommendationApp");jive.RecommendationApp.activityPageController=jive.oo.Class.extend(function(a){this.init=function(p){var f=this,e=jive.RecommendationApp,c=jive.eae.recommendation,h=new e.RecommendationModel(),b=$j("#j-discovery .j-reco-section"),j=$j("#recommended-for-you-module").length,d=[],g=["trendingContent","trendingUsers"],i={trendingMax:parseInt($j("#trendy").attr("data-max")),usersMax:parseInt($j("#trendy-users").attr("data-max"))},m;f.pollingInterval=(f.pollingInterval==undefined?p.pollingInterval:f.pollingInterval);f.firstDataFetched=f.firstDataFetched||null;if(b.length){function l(){if($j("#j-discovery").length){if(f.pollingInterval==0&&f.firstDataFetched!=null){o(f.firstDataFetched)}else{m().addCallback(o)}}}function o(r){if(f.pollingInterval==0&&f.firstDataFetched==null){f.firstDataFetched=r}$j.each(d,function(t){this.notify("newRecommendations",r[g[t]])});var s=b.not(":visible").filter(function(t){return d[t]&&d[t].isPopulated()}),q=$j.map(s,function(u,t){return function(){$j(u).fadeIn(500,function(){d[t].notify("uiUpdate",r[g[t]]);if(q.length){q.shift()()}})}});if(f.pollingInterval!=0){q.push(function(){setTimeout(l,f.pollingInterval)})}if(q.length){q.shift()()}}++i.trendingMax;if(j){g.unshift("recommendedPeople");g.unshift("recommendations");i.recommendedPeopleMax=parseInt($j("#user-reco-people").attr("data-max"));i.recommendationMax=parseInt($j("#user-reco-content").attr("data-max"));var n=new e.RecommendedForYouController(h,b.filter("#recommended-for-you-module"));n.addListener("invalidateCache",function(){f.firstDataFetched=null});d.push(n);var k=new e.RecommendedPeopleController(h,b.filter("#recommended-people-module"));k.addListener("invalidateCache",function(){f.firstDataFetched=null});d.push(k)}d.push(new e.GeneralRecommendationController(h,b.filter("#trendy-content-module"),c.activityTrendyContent));d.push(new e.GeneralRecommendationController(h,b.filter("#leaderboard-module"),c.leaderboard));m=h.getActivityHome.bind(h,i);l()}}});