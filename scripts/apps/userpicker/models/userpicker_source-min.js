jive.namespace("UserPicker");jive.UserPicker.Source=jive.oo.Class.extend(function(a){this.init=function(b){this.options=b;this.urls={userAutocomplete:jive.app.url("/user-autocomplete.jspa"),browseModal:jive.app.url("/user-autocomplete-modal.jspa")}};this.autocomplete=function(e){var g=new jive.conc.Promise(),c=this,b="",d=6500;if(c.lastAjaxObj){c.lastAjaxObj.abort()}var f={emailAllowed:c.options.emailAllowed,userAllowed:c.options.userAllowed,listAllowed:c.options.listAllowed,canInvitePartners:c.options.canInvitePartners,canInviteJustPartners:c.options.canInviteJustPartners,canInvitePreprovisioned:c.options.canInvitePreprovisioned,invitePreprovisionedDomainRestricted:c.options.invitePreprovisionedDomainRestricted,propNames:["avatarID","directMessageActionLinkShown"]};if(c.options.object){f=$j.extend(f,{objectID:c.options.object.objectID,objectType:c.options.object.objectType,entitlement:c.options.entitlement})}if(this.options&&this.options.filterIDs){this.options.filterIDs.forEach(function(h){b+=(b=="")?"?":"&";b+="args="+encodeURIComponent(h)})}if(this.options&&this.options.resultLimit){b+=(b=="")?"?":"&";b+="numResults="+encodeURIComponent(this.options.resultLimit)}if(e&&e.length>d){e=e.substring(0,d)}c.lastAjaxObj=$j.ajax({url:jive.rest.url("/users/search/"+encodeURI(e)+b),data:f,dataType:"json",success:function(h){g.emitSuccess(h)},error:function(h){g.emitError()}});return g};this.load=function(b){var e=new jive.conc.Promise();var c=this;var d={};if(c.options.object){d=$j.extend(d,{objectID:c.options.object.objectID,objectType:c.options.object.objectType,entitlement:c.options.entitlement})}$j.ajax({url:jive.rest.url("/users/"+b),dataType:"json",data:d,success:function(f){e.emitSuccess(f)},error:function(f){e.emitError(f)}});return e};this.save=function(d){var e=new jive.conc.Promise(),c=this;var b={};b[this.resourceType]=d;$j.ajax({type:"POST",url:this.RESOURCE_ENDPOINT+"/"+d.objectID+"/members",dataType:"json",data:JSON.stringify(b),contentType:"application/json; charset=utf-8",success:function(f,h,g){e.emitSuccess(f)},error:function(h,j,i){try{var g=$j.parseJSON(h.responseText);if(g&&g.error&&g.error.message){e.emitError(g.error.message,g.error.code)}}catch(f){e.emitError(null,h&&h.status)}}});return e}});