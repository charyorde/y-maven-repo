jive.namespace("DirectMessaging");jive.DirectMessaging.MessageSource=jive.RestService.extend(function(a,b){jive.conc.observable(this);a.resourceType="wall";a.pluralizedResourceType=a.resourceType;this.init=function(d,c){this.urlParams="/14/1";if(c&&c.trackingID){this.urlParams+="?sr="+c.trackingID}this.userSource=d;b.init.call(this,c)};this.getUsersByIds=function(){var c=this,f=new jive.conc.Promise(),e=Array.prototype.slice.call(arguments),g=[];function d(){if(e.length>0){c.userSource.get(e.shift()).addCallback(function(h){g.push(h);d()})}else{f.emitSuccess(g)}}d();return f};this.sendMessage=function(d){var c=new jive.conc.Promise();$j.ajax({data:JSON.stringify({wallentry:$j.extend({},d,{privateDM:true})}),type:"POST",url:this.RESOURCE_ENDPOINT+this.urlParams,dataType:"json",contentType:"application/json; charset=utf-8",success:function(e,g,f){c.emitSuccess(e)},error:function(g,i,h){try{var f=$j.parseJSON(g.responseText);if(f&&f.error&&f.error.message){c.emitError(f.error.message,f.error.code)}}catch(e){c.emitError(null,g&&g.status)}}});return c}});