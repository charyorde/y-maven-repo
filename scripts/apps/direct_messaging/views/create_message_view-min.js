jive.namespace("DirectMessaging");jive.DirectMessaging.CreateMessageView=function(){jive.conc.observable(this);var d={},b,a=[];function c(f){var e=f.find("input[name=share-users]").val().split(/\s*,\s*/);return $j.extend(microbloggingController.getMessageObject(),{userIDs:e})}this.notifyError=function(e){$j("<p />").html(e).message({style:"error"})};this.notifySuccess=function(){$j(jive.soy.direct_messaging.successMessage()).message({style:"success"})};this.setRecipients=function(e){a=e.concat([]);return this};this.hideModal=function(){b.trigger("close");return this};this.lockSubmit=function(){b.find("input.js-direct-messaging-form-submitBtn").prop("disabled",true)};this.unlockSubmit=function(){b.find("input.js-direct-messaging-form-submitBtn").prop("disabled",false)};this.openModal=function(){var e=this;b=$j(jive.soy.direct_messaging.modal());var f=b.find("input[type=text]").eq(0);b.lightbox_me({destroyOnClose:true,onLoad:function(){f.focus()}});jive.DirectMessaging.CreateMessageView.initializeUserPicker(f).setUsers(a);a=[];microbloggingController=jive.DirectMessaging.CreateMessageView.initializeMicroBloggingController();b.find("form.j-form").submit((function(h,g){e.lockSubmit();g.emit("form-submit",c($j(this)));h.preventDefault()}).partial(undefined,this))}};jive.DirectMessaging.CreateMessageView.initializeMicroBloggingController=function(){return new jive.DirectMessaging.MicroBloggingController()};jive.DirectMessaging.CreateMessageView.initializeUserPicker=function(a){return new jive.UserPicker.Main({multiple:true,listAllowed:true,emailAllowed:false,canInvitePartners:true,$input:a,relatedMessage:$j(jive.soy.direct_messaging.notRelated())})};