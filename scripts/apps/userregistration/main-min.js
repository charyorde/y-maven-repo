jive.namespace("UserRegistration");jive.UserRegistration.Main=jive.oo.Class.extend(function(a){this.init=function(c){var b=this;b.options=c||{};this.requiredFieldsOnly=(c.form&&c.form.requiredOnly)||c.requiredFieldsOnly||true;this.userRegSource=c.userRegSource||new jive.UserRegistration.Source(c);this.userRegSource.suppressGenericErrorMessages();this.authenticationSource=c.authenticationSource||new jive.Authentication.Source();this.userRegFormView=new jive.UserRegistration.RegistrationFormView(c);this.userRegFormView.addListener("register",function(d){b.userRegSource.getForm(b.requiredFieldsOnly).addCallback(function(e){d.emitSuccess(e)}).addErrback(function(){b.userRegSource.showGenericFindError()})});this.userRegFormView.addListener("validate",function(d,e){b.userRegSource.validate(d).addCallback(function(f){e.emitSuccess(f)}).addErrback(function(g,f,h){if(f!=400){b.userRegSource.showGenericSaveError()}e.emitError(h)})});this.userRegFormView.addListener("passwordstrength",function(e,d){b.userRegSource.checkPasswordStrength(e).addCallback(function(f){d.emitSuccess(f)}).addErrback(function(){b.userRegSource.showGenericSaveError();d.emitError()})});this.userRegFormView.addListener("submit",function(d,e){b.userRegSource.saveForm(d).addCallback(function(f){e.emitSuccess(f)}).addErrback(function(h,f,g){if(f!=400){b.userRegSource.showGenericSaveError()}e.emitError(g)})});this.userRegFormView.addListener("login",function(d,e){b.authenticationSource.login(d).addCallback(function(){e.emitSuccess()})})}});