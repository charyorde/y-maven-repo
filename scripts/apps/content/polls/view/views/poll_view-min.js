jive.namespace("PollView");jive.PollView.PollFormView=function(c,i){jive.conc.observable(this);var d=this,f=i.pollID,g;function a(j){g=j}function h(){$j(".j-vote-count").each(function(){var k=$j(this);var j=parseInt(k.outerWidth());var l=parseInt(k.parent(".j-val-poll-bar").outerWidth());if(!(j+36<l)&&j!=0&&l!=0){k.css({right:Math.min(-(j+9),-27)+"px","text-shadow":"0 1px 1px white"});k.addClass("font-color-normal").removeClass("font-color-white")}})}function b(j){if(j=="showOptions"){$j(c).find(".jive-poll-vote-list").hide();$j(c).find(".jive-poll-results-lists").fadeIn("fast");$j(c).find(".jive-poll-optionstgle").fadeIn("fast");$j(c).find(".jive-poll-resulttgle").hide();$j(c).find(".j-poll-buttons #vote").prop("disabled",true);$j(c).find(".jive-warn-box").hide()}else{$j(c).find(".jive-poll-vote-list").fadeIn("fast");$j(c).find(".jive-poll-results-lists").hide();$j(c).find(".jive-poll-optionstgle").hide();$j(c).find(".jive-poll-resulttgle").fadeIn("fast");$j(c).find(".j-poll-buttons #vote").prop("disabled",false)}h();return false}function e(){$j(c).find(".jive-success-box-vote").fadeIn("fast").delay(6000).fadeOut("slow");$j(c).find(".jive-warn-box-vote").hide();$j(c).find(".jive-poll-vote-list").hide();$j(c).find(".jive-poll-resulttgle").hide();$j(c).find(".jive-poll-votebtn").hide();$j(c).find(".jive-poll-vote-complete").fadeIn("fast");var j=jive.polls.view.soy.results({poll:g});$j(c).find(".jive-poll-results-lists").html(j);$j(c).find(".jive-poll-results-lists").fadeIn("fast");var k=jive.polls.view.soy.renderCount({count:g.votesCount});$j(c).find(".jive-vote-count").html(k);h()}this.results=b;this.vote=e;this.setContent=a;$j(document).ready(function(){$j(c).find("div.jive-success-box").delay(2000).fadeOut("slow").end().find(".jive-poll-votebtn").click(function(){var m=$j(c).find('input.vote[type="radio"]:checked');if(m.is("*")){var n=jive.polls.view.soy.renderProcessing();$j(c).find("input#vote").val(n).prop("disabled",true);d.emit("vote",f,m.val())}else{$j(c).find(".jive-warn-box-vote").show()}return false}).end().find(".jive-poll-results-toggle").click(function(){d.results("showOptions");return false}).end().find(".jive-poll-options-toggle").click(function(){d.results("showVotes");return false});$j(".j-poll-view ul li input:radio").each(function(){var o=$j(this);var n=$j('<a href="#" class="j-vote-box j-ui-elem j-empty-check" />');var m=$j(this).closest("li").find("label");o.css("opacity","0").after(n);if(o.is(":disabled")){n.removeClass("j-empty-check").addClass("j-disabled")}if(!o.is(":disabled")){n.add(m).hover(function(){l(m,n,o)},function(){j(m,n,o)});n.click(function(p){o.trigger("click");p.preventDefault()})}o.focusin(function(){l(m,n,o)}).focusout(function(){j(m,n,o)});o.click(function(){k(m,n,o)})});function l(m,n,o){m.addClass("font-color-link");n.addClass("hover")}function j(m,n,o){m.removeClass("font-color-link");n.removeClass("hover")}function k(m,o,q){var p=$j('<span class="j-vote-box j-ui-elem j-check popped" />');var n=o.closest("ul");n.find(".j-check").remove();n.find(".j-choice").removeClass("j-choice");n.find(".font-color-okay").removeClass("font-color-okay");o.after(p);o.closest("li").addClass("j-choice").find("label").addClass("font-color-okay")}h()})};