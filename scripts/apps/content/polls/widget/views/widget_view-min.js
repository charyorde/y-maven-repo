jive.namespace("PollWidget");jive.PollWidget.WidgetView=function(p,c){jive.conc.observable(this);var m,k=c.pollID,o=0,j,h,r=c.moreUrl,l=c.widgetID,q=c.createUrl,f=this;function n(){$j(p).find("#load-indicator").hide();return this}function b(){$j(p).find("#load-indicator").hide();return this}function e(u){var t=$j(p);t.find("input#vote").prop("disabled",false);if(t.closest("div.js-full-content-container").length&&u.votesCount){var s=t.closest("div.js-full-content-container").find(".j-act-poll-votect");s.html(jive.eae.poll.common.voteCount({numOfVotes:u.votesCount}))}return this}function i(s){m=s;k=m.id;o=m.index;a()}function g(u,s){var t;if(s){t=jive.polls.widget.soy.errorWithLink({createUrl:q})}else{t=jive.polls.widget.soy.error({message:u})}$j(p).html(t)}function d(){return $j(p)}function a(){var s=jive.polls.widget.soy.poll({poll:m,moreUrl:r,widgetID:l});$j(p).html(s)}this.next=n;this.previous=b;this.vote=e;this.setContent=i;this.displayError=g;$j(document).ready(function(){$j(p).find(".j-pgnav-next").live("click",function(){j=($j(this).attr("id")||"").split("-").last();$j(p).find("#load-indicator").fadeIn("fast");f.emit("next",j);return false}).end().find(".j-pgnav-prev").live("click",function(){h=($j(this).attr("id")||"").split("-").last();$j(p).find("#load-indicator").fadeIn("fast");f.emit("previous",h);return false}).end().find(".jive-poll-votebtn").live("click",function(){var v=$j(p).find("input[type=radio]:checked");if(v.is("*")){$j(p).find("input#vote").val(jive.polls.widget.soy.voteProcessing()).prop("disabled",true);f.emit("vote",k,v.val(),o)}else{$j(p).find(".jive-warn-box").fadeIn("fast")}return false});$j(p).find(".j-poll-stream ol li input:radio").each(function(){var x=$j(this);var w=$j('<a href="#" class="j-vote-box j-ui-elem j-empty-check" />');var v=$j(this).closest("li").find("label");x.css("opacity","0").after(w);if(x.is(":disabled")){w.removeClass("j-empty-check").addClass("j-disabled")}if(!x.is(":disabled")){w.add(v).hover(function(){u(v,w,x)},function(){s(v,w,x)});w.click(function(y){x.trigger("click");y.preventDefault()})}x.focusin(function(){u(v,w,x)}).focusout(function(){s(v,w,x)});x.click(function(){t(v,w,x)})});function u(v,w,x){v.addClass("font-color-link");w.addClass("hover")}function s(v,w,x){v.removeClass("font-color-link");w.removeClass("hover")}function t(v,x,z){var y=$j('<span class="j-vote-box j-ui-elem j-check popped" />');var w=x.closest("ol");w.find(".j-check").remove();w.find(".j-choice").removeClass("j-choice");w.find(".font-color-okay").removeClass("font-color-okay");x.after(y);x.closest("li").addClass("j-choice").find("label").addClass("font-color-okay")}})};