jive.namespace("content.common");ContentRTE=$Class.extend({init:function(o){var e=jQuery;this.options=e.extend({autoSave:{},rteOptions:{}},o);this.options.autoSave.properties=e.merge(["publishBar"],this.options.autoSave.properties||{});this.options.rteOptions=e.extend({preset:"thread"},this.options.rteOptions);o=this.options;var m=this.options.actionBean;var d="wysiwygtext";var f=e("#"+d);var c=f.closest("form");var k=(m.containerContextBean)?m.containerContextBean.container.objectType:-1;var n=(m.containerContextBean)?m.containerContextBean.container.objectID:0;var j=m.videoPickerURL;var b={entitlementService:new jive.rte.EntitlementService({objectType:k,objectID:n,entitlement:"VIEW"}),formService:new jive.rte.FormService({$form:c})};b.attachmentService=new jive.rte.FormAttachmentService({container:c,name:"attachFile",attachments:m.attachments,$form:c,maxSize:m.attachmentConfigActionBean.maxAttachmentSize,maxFiles:m.attachmentConfigActionBean.maxAttachments,allowByDefault:m.attachmentConfigActionBean.allowByDefault,attachmentExtensions:m.attachmentConfigActionBean.attachmentExtensions,hasAttachPerms:m.hasAttachPerms});if(m.contentType==1){var l=2;var a=(m.rootMessageID?m.rootMessageID:-1)}b.imageService=new jive.rte.ImageService({objectId:(a?a:m.objectID)||-1,objectType:(l?l:m.contentType)||-1,containerType:k,containerId:n});window._jive_video_picker__url=j;var i=e.extend({$element:f,preferredMode:m.preferredMode,toggleText:jive.i18n.getMsg("rte.toggle_display"),alwaysUseTabText:jive.i18n.getMsg("post.alwaysUseThisEditor.tab"),images_enabled:m.hasImagePerms,services:b,mobileUI:m.mobileUI,isEditing:!m.create,communityName:m.communityName,editDisabledText:jive.i18n.getMsg("rte.edit.disabled"),editDisabledSummary:jive.i18n.getMsg("rte.edit.disabled.desc")},this.options.rteOptions);var h;var g=function(q){var p=window.editor.get(d).getHTML();f.val(p);if(!m.guest){h.pause()}};c.submit(g);i.onReady=function(){if(!m.guest){var p={selector:c,objectType:m.contentType,draftObjectType:k,draftObjectID:n,editorId:d,subject:"subject"};if(m.objectID){p.draftObjectType=m.contentType;p.draftObjectID=m.objectID}h=new jive.draft.Main(e.extend(p,o.autoSave))}};this.rte=new jive.rte.RTEWrap(i)},focusOnGUIEditor:function(b){var a=b.keyCode;if(a==9&&!b.shiftKey){this.rte.focus();return false}}});