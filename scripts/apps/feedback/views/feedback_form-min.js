define("jive.Feedback.FeedbackForm",["jive.AbstractView"],function(a){return a.extend(function(b,c){var d=jQuery;b.init=function(f){var e=this;this.options=d.extend({sizeLimit:4000},f);this.content=d(jive.feedback.form(this.options));this.content.find("form").submit(function(g){g.preventDefault();e.emit("submit",e.formData(this))});this.watchForChanges(this.content.find("textarea"),function(g){e.content.find(".js-counter").replaceWith(jive.feedback.charCounter({current:g.length,max:e.options.sizeLimit}))});this.content.find(".js-cancel").click(function(h){h.preventDefault();var g=d(this).closest("form");e.emit("close",e.formData(g))})};this.show=function(){this.content.appendTo("body");this.content.find('[name="comments"]').focus();return this};this.remove=function(){clearTimeout(this.pollTimeout);return c.remove.call(this)};b.formData=function(f){var e=this.content.find("form");var g=e.find('[name="comments"]').val().slice(0,this.options.sizeLimit);return{comments:g}};b.watchForChanges=function(f,i){var e=this,g=f.val();this.pollTimeout=setTimeout(function h(){var j=f.val();if(j!=g){i.call(f,j);g=j}e.pollTimeout=setTimeout(h,250)},250)}})});