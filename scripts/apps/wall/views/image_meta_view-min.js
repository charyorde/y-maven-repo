jive.namespace("Wall");if(!jive.Wall.ImageMetaView){jive.Wall.ImageMetaView=jive.Wall.MetaView.extend({init:function(f,a,e,b,c){this._super(f,a,e,b,c);var d=this;this._$container.find("form").submit(function(){if(d._$container.find("input[type=file]").val()==""){return false}if(d._$imageContainer.find("UL").length==0){d.add([])}d.emit("completed",$j(this));return false});this._$imageContainer=e.find(".jive-js-image-container");this._i18n=b.i18n},error:function(a,c,b){this.emit("error",c);if($j(this._$imageContainer).find("ul li").size()==1){this.reset()}this.hide();$j(this._$imageContainer).find("li.j-attached-loading").hide()},add:function(e,c){c=c||"";var d=this;var a=this._$imageContainer.find("ul.j-attached-items");if(e.length>0){var f=e[0];$j.extend(f,{originalURL:c});a=this._$imageContainer.find("ul.j-attached-items");if(a.length>0){jive.StatusInput.renderAttachmentWrapper({attachment:f},a,true)}else{jive.StatusInput.renderAttachmentsWrapper({attachments:e},this._$imageContainer,true)}if(this._type==jive.Wall.MetaView.TYPE_STATUS){this._$container.hide();this._$anchor.removeClass("j-selected").siblings(".j-button").removeClass("j-deselected")}}else{if(d._$imageContainer.find("UL").length==0){jive.StatusInput.renderAttachmentsWrapper({attachments:e},this._$imageContainer,true)}}this._$container.hide();this._$anchor.removeClass("j-selected").siblings(".j-button").removeClass("j-deselected");this._$imageContainer.find("li:not(.j-attached-loading):last > .j-remove-attachment").click(function(){d.emit("removeImage",f.id)});if(e.length>0){var b=this._$imageContainer.find("li.j-attached-loading").remove();b=$j(b.hide().get(0));this._$imageContainer.find("ul.j-attached-items").append(b);jive.StatusInput.bindAttachment(a,true)}},reset:function(){this._$imageContainer.html("");this._$imageContainer.hide();this._$imageContainer.find("li.j-attached-loading").hide()},show:function(){var c=this._$container.find("input[type=file]");var b=$j("<input type='file'>");b.attr("name",c.attr("name"));this._$container.find("input[type=file]").before(b).remove();var a=this;this._fileInputInterval=setInterval(function(){if(b.val()){clearInterval(a._fileInputInterval);a._$container.find("form").submit()}},100);this._super()},hide:function(){clearInterval(this._fileInputInterval);this._super()},getDataForURLImage:function(a){var b=this._$container.find("form");b.find("input[name=imageURL]").val(a);return b},remove:function(a){if($j("#"+a).size()>0&&$j("#"+a).siblings().size()<=1){this.reset()}$j("#"+a).remove()},formSubmitted:function(){var a=this._$imageContainer.find("ul.j-attached-items");a.width(a.width()+90+"px");this._$imageContainer.find("li.j-attached-loading").show();var b=a.width()-this._$imageContainer.width();if(b>0){a.animate({left:(b*-1-40)},300)}}})};