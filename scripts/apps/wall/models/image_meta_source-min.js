jive.namespace("Wall");if(!jive.Wall.ImageMetaSource){jive.Wall.ImageMetaSource=jive.Wall.MetaSource.extend({init:function(){this.META_ENDPOINT=jive.rest.url("/meta")},create:function(e,g,c,h,a){var i=this;var b=jive.rest.url("/meta/imageJackson/"+e.objectType+"/"+e.objectId+"/attachment");var f="";if(a){console.log("Got image url");f=encodeURIComponent(g.find("input[name=imageURL]").val());b=jive.rest.url("/meta/imageJackson/"+e.objectType+"/"+e.objectId)}var j={url:b,dataType:"xml",data:{imageURL:f},contentType:"text/xml; charset=utf-8",complete:function(l,k){if($j(l.responseXML).find("meta id").length>0){i.fetch($j(l.responseXML).find("meta id").text(),c,h)}else{var n=$j(l.responseXML).find("code").text();var m=$j(l.responseXML).find("message").text();h(l,m,n)}},error:function(m,o,n){console.log("Error jive.Wall.ImageMetaSource create"+m+", "+o+", "+n);var l=$j(m.responseXML).find("code").text();var k=$j(m.responseXML).find("message").text();h(m,k,l)}};if(a){var d=g.find("input[name=image]");if(d.length>0){d.val("")}}else{g.find("input[name=imageURL]").val("")}g.ajaxSubmit(j)},fetch:function(d,a,b){var c={type:"GET",url:this.META_ENDPOINT+"/"+d,dataType:"json",contentType:"application/json; charset=utf-8",success:function(e){if(e.meta.length>0){var f=e.meta[0];a(e.meta)}else{console.log("Error jive.Wall.ImageMetaSource fetch no meta data:"+e);b(e,null,null)}},error:function(e,g,f){console.log("Error jive.Wall.ImageMetaSource fetch"+e+", "+g+", "+f);b(e,g,f)}};$j.ajax(c)}})};