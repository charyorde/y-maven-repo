jive.namespace("ReadTracking");jive.ReadTracking.Main=jive.oo.Class.extend(function(a){this.init=function(c){var b=this;this.i18n=c.i18n;this.readTrackingSource=new jive.ReadTracking.ReadTrackingSource(c);this.readTrackingView=new jive.ReadTracking.ReadTrackingView(c);this.readTrackingView.addListener("markRead",function(d,g,e,f){b.readTrackingSource.save(d,g,f).addCallback(function(){jive.switchboard.emit((f?"inbox.read":"inbox.unread"),d,g,e)})}).addListener("markAllRead",function(){var d=jive.ActivityStream.GlobalCommunicationStreamController.getLastLoadTime();b.readTrackingSource.markAllRead(d).addCallback(function(){jive.switchboard.emit("inbox.markAllRead");jive.ActivityStream.GlobalCommunicationStreamController.getUnreadSinceLastUpdate().forEach(function(f,e){b.readTrackingSource.save(f.objectType,f.objectId,true)});jive.ActivityStream.GlobalCommunicationStreamController.clearUnreadSinceLastUpdate()})})};this.attachReadActions=function(){this.readTrackingView.postRender()};this.markRead=function(b){this.readTrackingView.markRead(b)};this.markUnread=function(b){this.readTrackingView.markUnread(b)};this.markAllRead=function(b){this.readTrackingView.markAllRead(b)}});