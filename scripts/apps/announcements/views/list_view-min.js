jive.namespace("Announcements");jive.Announcements.ListView=jive.AbstractView.extend(function(a){var b=jQuery;a.init=function(d){var c=this;this.$element=b(d.element);this.$announcementlist=this.$element.find(".jive-modal-announcement-list");this.$tbody=this.$announcementlist.find("table tbody");this.$announcementlist.endlessScroll({callback:function(e){c.emit("page",e)},insertAfter:b()});this.$element.find(".jive-modal-announcements-listing .add a").add("#jive-new-announcement a, #jive-another-announcement a").bind("click.announcements",function(f){c.emit("create");f.preventDefault()});this.content=b().add(this.$element.find(".jive-modal-title-manage-announcements")).add(this.$element.find(".jive-modal-announcements-listing")).add(this.$element.find(".add"))};this.update=function(c){this.populate(c)};this.reload=function(d){var c=this;this.$tbody.children().remove();this.populate(d);this.$announcementlist.endlessScroll({callback:function(e){c.emit("page",e)},insertAfter:b()})};this.expire=function(c){this.content.find("tr").filter(function(){return b(this).data("object-id")==c.id}).replaceWith(jive.announcements.manageRow(c));this.rebindEvents()};this.removeChild=function(c){var d=this.content.find("tr").filter(function(){return b(this).data("object-id")==c.id});d.fadeOut(function(){d.remove()})};a.populate=function(e){var c=this.$tbody,d=this;this.showSpinner({context:c,showLabel:false});e.addCallback(function(g){c.children(":not(tr)").remove();if((!g||g.length<1)&&c.children().length<1){c.html(d.noResults())}var f=[];g.forEach(function(h){f.push(jive.announcements.manageRow(h))});c.append(f.join(""));d.rebindEvents()}).always(function(){d.hideSpinner()})};a.noResults=function(){return b(jive.announcements.noResults())};a.rebindEvents=function(){var c=this;this.$element.find(".updateViewLink").unbind("click.announcementlisting").bind("click.announcementlisting",function(d){var e=b(this).closest("tr").data("object-id");c.emit("edit",e);d.preventDefault()});this.$element.find(".expireRemoveLink").unbind("click.announcementlisting").bind("click.announcementlisting",function(e){var f=b(this).closest("tr"),g=f.data("object-id"),d=f.data("object-status");if(d=="expired"){if(window.confirm(jive.announcements.confirmDelete())){c.emit("remove",g)}}else{if(window.confirm(jive.announcements.confirmExpire())){c.emit("expire",g)}}e.preventDefault()})}});