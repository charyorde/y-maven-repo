jive.namespace("project.TaskList");jive.project.TaskList=jive.oo.Class.extend(function(c){var d="grouped",a="flat",b="incomplete",e="complete",f=jQuery;c.init=function(l,k,j){var h=new jive.FollowApp.Main({objectType:602,objectID:null,featureName:"task",i18n:null}),i=this.initMode.bind(this),g=this;this.mode=l;this.filter=k;this.userID=j;f(document).ready(function(){var m=f('[id="'+jivetasklist.containerID+'"]');i();m.delegate("#j-task-groupview-sel","click",function(n){g.switchToGrouped();n.preventDefault()});m.delegate("#show-completed","click",function(o){var n=g.filter==e?b:e;jivetasklist.setMode(d);jivetasklist.setFilter(n);jivetasklist.reload(function(){g.filter=n;i()})});m.delegate("#task-assignee","change",function(){jivetasklist.setOwnerID(this.value);jivetasklist.reload(i)});m.delegate("#task-project","change",function(){jivetasklist.setProjectID(this.value);jivetasklist.reload(i)});m.delegate("#j-task-flatview-sel","click",function(n){g.switchToFlat();n.preventDefault()});m.delegate("#task-state-incomplete","click",function(n){jivetasklist.setMode(a);jivetasklist.setFilter(b);jivetasklist.reload(i)});m.delegate("#task-state-complete","click",function(n){jivetasklist.setMode(a);jivetasklist.setFilter(e);jivetasklist.reload(i)});m.delegate(".js-pagination","click",function(n){jivetasklist.setStart(f(this).data("start"));jivetasklist.reload(i);n.preventDefault()});m.delegate(".js-task-checkbox","click",function(o){var p=f(this),n=!p.is(":checked"),r=p.data("id"),q=p.data("owner-id");if(n){jivetasklist.markTaskIncomplete(r,i)}else{if(q&&g.userID!=q){if(window.confirm(jive.project.tasks.markCompleteConfirm())){jivetasklist.markTaskComplete(r,i)}else{o.preventDefault()}}else{jivetasklist.markTaskComplete(r,i)}}});m.delegate(".js-task-more, .js-task-less","click",function(n){jivetasklist.toggleTaskDetails(f(this).data("id"));n.preventDefault()});m.delegate(".js-delete-task","click",function(n){jivetasklist.deleteTask(f(this).data("id"));n.preventDefault()});m.delegate(".js-take-task","click",function(n){jivetasklist.takeTask(f(this).data("id"));n.preventDefault()})})};c.initMode=function(){if(this.mode==d){this.selectGrouped()}else{this.selectFlat()}};c.selectGrouped=function(){f("#flat-options").hide();f("#grouped-options").fadeIn("fast");f("#task-view-f").removeClass("selected");f("#task-view-g").addClass("selected");f("#task-view-g a").hide();f("#task-view-f a").show();f("#task-view-g strong").show();f("#task-view-f strong").hide()};c.switchToGrouped=function(){var g=this;this.selectGrouped();jivetasklist.setMode(d);jivetasklist.reload(function(){g.mode=d;g.initMode()})};c.selectFlat=function(){f("#grouped-options").hide();f("#flat-options").fadeIn("fast");f("#task-view-g").removeClass("selected");f("#task-view-f").addClass("selected");f("#task-view-g a").show();f("#task-view-f a").hide();f("#task-view-g strong").hide();f("#task-view-f strong").show()};c.switchToFlat=function(){var g=this;this.selectFlat();jivetasklist.setMode(a);jivetasklist.reload(function(){g.mode=a;g.initMode()})}});