jive.namespace("DirectorySettings");jive.DirectorySettings.ServerFormView=jive.DirectorySettings.AbstractDirectorySettingsFormView.extend(function(a){a.init=function(c){var b=this;b.options=c||{};b.form=c.form||{};b.configured=c.configured||false;b.$form=$j("#jive-directory-server-settings-form");b.attachToolTipHandlers(b.$form);b.attachServerTypeHandler(b.$form);b.attachTestHandler(b.$form);b.attachSaveHandler(b.$form);b.attachResetHandler(b.$form)};a.attachServerTypeHandler=function(c){var b=this;c.find("#serverType, #sslEnabled").change(function(f){var d=$j(this).val();if(d&&d!="1"){b.emitP("getServerSettings",{serverTypeID:$j("#serverType").val(),sslEnabled:$j("#sslEnabled").is(":checked")}).addCallback(function(e){b.$form.find("#port").val(e.port.val);b.$form.find("#followReferrals").attr("checked",e.followReferrals.val)})}})};a.attachResetHandler=function(c){var b=this;c.find("input[name='reset']").click(function(d){if(b.configured){if(confirm(jive.admin.directory.settings.resetConfirmMessage())){b.emitP("resetConfigs").addCallback(function(){window.location.reload()})}}else{window.location.reload()}d.preventDefault()})};a.submitForm=function(c){var b=this;if(!c.is(":disabled")){b.showSpinner();b.gatherFormValues();b.disableSaveButton();b.disableTestButton();b.hideErrors();b.emitP("saveServerSettings",b.form).addCallback(function(d){if(d.valid){if(b.form.test){b.enableSaveButton()}else{b.configured=true}b.showResult(true,d)}else{b.showResult(false,d)}b.hideStatus()}).addErrback(function(d){b.displayErrors(d);b.hideStatus();b.hideResult()}).always(function(){b.hideSpinner();b.enableTestButton()})}};a.showStatus=function(b){$j("#js-server-status-holder").html(jive.admin.directory.settings.serverStatus(b))};a.showResult=function(d,c){var b=this;if(d){if(!b.form.test){$j(".jive-body-tabbar").show()}$j("#js-result-message-holder").html(jive.admin.directory.settings.successMessage({test:b.form.test,status:c}))}else{$j("#js-result-message-holder").html(jive.admin.directory.settings.serverStatus(c))}}});