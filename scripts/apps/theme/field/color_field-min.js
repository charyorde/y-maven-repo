jive.namespace("Theme");jive.Theme.ColorField=function(k){var n=k.closest(".j-js-housing"),c=n.find(".j-js-color-display"),a=n.find(".j-js-color-info"),i=k.data("can-be-transparent"),g={},l={},e={},h={};var f=function(o){if(!d(o)){throw"Invalid argument: "+(o||"")}return"#"+o.replace("#","")};var d=function(o){return/^#?(([a-f\d]){3}){1,2}$/i.test(o||"")};var m=function(o){if(o===l){return f(k.val())}else{if(o===h){return"transparent"}}return""};var j=function(o){o=$j.trim(o);if(!o){return i?h:g}else{if(o.toLowerCase()==="transparent"){return h}}return d(o)?l:e};var b=function(r,s){var o=m(r),q=a.text(),p="";c.css("backgroundColor",o);n.toggleClass("transparent",r===h);if(r===l||r===h){c.stop().css("opacity",1).css("backgroundColor",o)}else{c.stop().css("backgroundColor",o).animate({opacity:0.3},s)}if(r!==l){p=r===h?jive.theme.colorTransparent():jive.theme.colorInvalid()}if(!q&&p){a.text(p).fadeIn(s)}else{if(q&&!p){a.fadeOut(s,a.text.bind(a,""))}else{if(q&&p&&q!==p){a.fadeOut(s,function(){a.text(p).fadeIn(s)})}}}};k.bind("keyup paste change",function(q){var p=j(k.val()),o=m(p);b(p,"fast");k.trigger("cssUpdate",[o])});return{setValue:function(q){var o=j(q);if(o===l){var p=f(q).replace("#","");k.val(p)}b(o,0)}}};