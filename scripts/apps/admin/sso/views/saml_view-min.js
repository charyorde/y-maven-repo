jive.namespace("SSOAdminApp");jive.SSOAdminApp.SAMLView=jive.oo.Class.extend(function(a){jive.conc.observable(this);this.init=function(c){var b=this;$j(document).ready(function(){var d=$j("#saml-save");new jive.Validator({form:d});d.submit(function(g){if(!g.isDefaultPrevented()){var h=jsonifyForm($j("#saml-save :input").not("[id|=upload-keystore]"));h.fields=[];var f=h.fieldIds;f.forEach(function(i){var e={id:i,attribute:h["attribute-"+i],federated:h["federated-"+i]};h.fields.push(e);delete h["attribute-"+i];delete h["federated-"+i]});delete h.fieldIds;b.emit("save",h);g.preventDefault()}});$j("#load-metadata").click(function(f){f.preventDefault();hideMessages();b.emit("load-metadata",{url:$j("#load-metadata-url").val()})});$j("#download-keystore").click(function(f){f.preventDefault();if(confirm(jive.i18n.getMsg("admin.sso.keystore.download.confirm"))){b.emit("download-keystore")}});$j("#upload-keystore").click(function(h){h.preventDefault();var f=$j("#upload-keystore-password");var g=$j("#upload-keystore-file");f.replaceWith(f.clone());g.replaceWith(g.clone());if(confirm(jive.i18n.getMsg("admin.sso.keystore.upload.confirm"))){b.emit("upload-keystore",{inputs:$j(null).add(f).add(g).removeAttr("id")})}})})},this.metadataLoaded=function(b){if(response(b)){$j("#metadata").val(b.metadata);loadAttributes(b.attributes)}},this.save=function(b){if(response(b)){loadAttributes(b.attributes)}}});function loadAttributes(c){var b=$j("#saml-attributes");b.hide();if(c&&c.length>0){var a=$j(jive.admin.sso.attributes({attributes:c}));b.html(a);b.show()}};