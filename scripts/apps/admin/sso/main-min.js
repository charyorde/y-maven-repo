jive.app("SSOAdminApp");jive.SSOAdminApp.Main=jive.oo.Class.extend(function(a){var b=jive.SSOAdminApp;this.init=function(d){var c=this;switch(d.tab){case"sso":this.view=new b.SSOView(d);this.model=new b.SSOModel(d);this.view.addListener("save",function(e){hideMessages();c.model.save(e).addCallback(function(f){response(f)})});break;case"saml":this.view=new b.SAMLView(d);this.model=new b.SAMLModel(d);this.view.addListener("load-metadata",function(e){c.model.loadMetadata(e).addCallback(function(f){c.view.metadataLoaded(f)})});this.view.addListener("download-keystore",function(e){hideMessages();c.model.downloadKeystore(e)});this.view.addListener("upload-keystore",function(e){hideMessages();c.model.uploadKeystore(e).addCallback(function(f){response(f)})});this.view.addListener("save",function(e){hideMessages();c.model.save(e).addCallback(function(f){c.view.save(f)})});break;case"kerberos":this.view=new b.KerberosView(d);this.model=new b.KerberosModel(d);this.view.addListener("save",function(e){hideMessages();c.model.save(e).addCallback(function(f){response(f)})});break;case"external-login":this.view=new b.ExternalLoginView(d);this.model=new b.ExternalLoginModel(d);this.view.addListener("save",function(e){hideMessages();c.model.save(e).addCallback(function(f){response(f)})});break}$j(document).ready(function(){$j(".w-options").each(function(){var e=$j(this);e.click(expander);expander.call(e)});$j(".sso-enable li").click(function(){var e=$j(this);if(!e.hasClass("checked")){var f=e.parent().find("li.checked");f.removeClass("checked");f.find("input").prop("checked",false);e.addClass("checked");e.find("input").prop("checked",true)}});$j(".sso-subtab .jive-body-tab").each(function(){var e=$j(this);e.find("a").click(function(){$j(".sso-subtab-content").each(function(){$j(this).hide()});$j(".sso-subtab .jive-body-tab").each(function(){$j(this).removeClass("jive-body-tabcurrent active")});var f=$j(this);var h=f.closest(".jive-body-tab");h.addClass("jive-body-tabcurrent active");var g=$j("#jive-"+f.attr("ref")+"-tab-content");g.show()})})})}});function hideMessages(){$j(".jive-success-box").hide();$j(".jive-error-box").hide()}function response(c){if(c.error){var a=$j("#jive-error-box");a.find("span.message").text(c.error);setDetail(a,c);a.show();return false}else{if(c.message){var b=$j("#jive-success-box");b.find("span.message").text(c.message);setDetail(b,c);b.show();return true}}return false}function setDetail(b,d){if(d.detail){var a=$j("<a/>");a.text(" Show Detail");a.click(function(){b.find("span.message .jive-error-detail").show();a.hide()});var c=b.find("span.message");c.append(a);c.append($j('<pre class="jive-error-detail">').text(d.detail).hide())}}function expander(){var b=$j(this);var a=$j("#"+b.attr("id")+"-options");if(b.is(":checked")||b.attr("ref")=="closed"){b.attr("ref","open");a.show()}else{b.attr("ref","closed");a.hide()}}function jsonifyForm(b){var a=b.serializeArray();var c={};$j.each(a,function(){if(c[this.name]){if(!c[this.name].push){c[this.name]=[c[this.name]]}if(this.value){c[this.name].push(this.value||"")}}else{if(this.value){c[this.name]=this.value||""}}});return c};