jive.namespace("admin.conversion.settings");jive.admin.conversion.settings.View=jive.oo.Class.extend(function(c){jive.conc.observable(this);this.init=function(i){var h=this;$j(document).ready(function(){$j('input[name="fullTest"]').click(function(j){h.emit("fullTest",$j(this));j.preventDefault()});$j("#jive-conversion-add-node").click(function(k){var j=h.addHost();$j("#jive-conversion-processing-node-office-test-button-"+j).click(function(){h.emit("testOfficeToPDF",$j(this))});$j("#jive-conversion-processing-node-pdf2swf-test-button-"+j).click(function(){h.emit("testPdfToSwf",$j(this))});$j("#service-stats-"+j).click(function(l){var m=$j(this).closest(".node-fieldset").find(".host-services");m.toggle();if(m.is(":visible")){h.emit("serviceStats",$j(this))}l.preventDefault()});k.preventDefault()});$j("#admin-conversion-settings-form input:submit").click(function(k){k.preventDefault();var j=h.serializeSettings();h.emit("settingsSaved",j);$j(this).prop("disabled",true)});$j.each(i.hosts,function(){var j=h.addHost();$j("#jive-conversion-processing-node-host-"+j).val(this);$j("#jive-conversion-processing-node-office-test-button-"+j).click(function(){h.emit("testOfficeToPDF",$j(this))});$j("#jive-conversion-processing-node-pdf2swf-test-button-"+j).click(function(){h.emit("testPdfToSwf",$j(this))});$j("#service-stats-"+j).click(function(k){var l=$j(this).closest(".node-fieldset").find(".host-services");l.toggle();if(l.is(":visible")){h.emit("serviceStats",$j(this))}k.preventDefault()})})})};c.addHost=function g(){var h=$j("#node-list").children().length;$j("#node-list").append($j(jive.admin.conversion.settings.hostBlock({index:h})));$j("#remove-host-"+h).click(function(i){$j("#host-"+h).remove();i.preventDefault()});return h};c.serializeSettings=function d(){var h={};$j.each($j("#admin-conversion-settings-form").serializeArray(),function(){h[this.name]=this.value});h.disabledExtensions=(h.disabledExtensions||"").split(",");h.processingNodes=$j.isArray(h.processingNodes)?h.processingNodes:[h.processingNodes];return h};this.saveSuccess=function f(h){$j(".jive-success-box").animate({opacity:"toggle"},"slow","linear",setTimeout(function(){$j(".jive-success-box").animate({opacity:"toggle"},"slow","linear",function(){$j("#admin-conversion-settings-form input:submit").prop("disabled",false)})},8000));if(!h){$j(".jive-warn-box").show()}else{$j(".jive-warn-box").hide()}};this.displayStats=function b(j,i){var h=i.find(".jive-conversion-processing-node-status");h.empty().append(c.objectToList(j))};this.displayTestResults=function a(h){var i=$j('input[name="fullTest"]').next();if(h.error){i.empty().append("Error: "+h.errorMessage)}else{if(!h.error&&!h.converting){i.empty().append("Success!")}}};c.objectToList=function e(h){var i='<ul class="status-list">';$j.each(h,function(j,k){i+="<li>"+j;if(typeof k=="object"){i+=c.objectToList(k)}else{i+=":"+k}i+="</li>"});i+="</ul>";return i}});