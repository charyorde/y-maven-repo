jive.namespace("Filters");jive.Filters.SpaceHierarchyView=jive.AbstractView.extend(function(a){var b=jQuery;this.init=function(e,g,f,c){var d=this;d.omitIcons=c||false;this.extraParams=g;this.baseNode=b(e);d.setItemViewID(f);this.baseNode.find("a.j-view-children").live("click",function(m){var j=b(this);var o=j.data("objecttype");var h=j.data("objectid");var i=j.closest(".j-hierarchy-item");var n=i.find(".j-hierarchy-child-holder");var k=n.data("children-loaded");var l=d.isHierarchyViewSelected();if(k&&l){n.toggle("fast")}else{d.baseNode.find(".j-loading-container").remove();d.emit("viewSubspaces",o,h);if(n){n.slideToggle("fast")}}i.find(".j-hide-children-msg").toggle();i.find(".j-show-children-msg").toggle();m.preventDefault()});this.baseNode.find(".up-to-parent-space").live("click",function(i){var j=b(this).data("object-type");var h=b(this).data("object-id");d.emit("viewSubspaces",j,h);i.preventDefault()});this.baseNode.find(".j-hierarchy-more").live("click",function(l){var i=b(this);var m=i.data("parent-objectid");var n=b(this).data("index-start");var h=b(this).data("index-end");var k=b(this).data("direction");var j=b(jive.shared.soy.loading());i.replaceWith(j);d.emitP("viewSiblings",m,n,h).addCallback(function(o){if(k==1){delete o[0].prop.beforeInfo}else{delete o[o.length-1].prop.afterInfo}j.replaceWith(jive.browse.grid.hierarchyItems({items:o,omitIcons:d.omitIcons}))}).always(function(){d.baseNode.find(".j-loading-container").remove()});l.preventDefault()})};this.isHierarchyViewSelected=function(){return this.itemViewID=="hierarchy"};this.setItemViewID=function(c){this.itemViewID=c};this.update=function(d){var c=this;d.addCallback(function(f){if(f.itemViewID!="hierarchy"){if(f.containerName&&(!c.extraParams||(f.containerID!=c.extraParams.containerID))){b("#parent-space-message").show();var e=f;if(c.extraParams&&c.extraParams.containerType&&c.extraParams.containerID){e=$j.extend(e,{startID:c.extraParams.containerID,startType:c.extraParams.containerType})}b("#parent-space-message").html(jive.places.parentChain(e))}else{b("#parent-space-message").hide()}b(".j-browse-search").show();b("#j-sort").show()}else{b(".j-browse-search").hide();b("#j-sort").hide();b("#parent-space-message").hide()}})}});