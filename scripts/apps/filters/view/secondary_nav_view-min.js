jive.namespace("Filters");jive.Filters.SecondaryNavView=jive.AbstractView.extend(function(a){var b=jQuery;a.init=function(e,d,f){var c=this;this.$nav=b(e||"nav.j-second-nav");this.pinnedFilter=d;this.guest=f;this.$nav.delegate("a.js-select-link","click",function(j){var i=b(this),h=i.closest("li"),g=h.attr("data-filter-id");if(g){c.emitP("navSelect",[g]).addErrback(c.lastStateSwitcher())}j.preventDefault()});this.$nav.delegate(".js-clear-nav a","click",function(i){var j=c.$nav.find(".active_item"),g=j.attr("data-filter-id"),h=c.$nav.find(".active_nested_item").attr("data-filter-id");c.emitP("navSelect",[]).addErrback(c.lastStateSwitcher());i.preventDefault()});this.$nav.delegate("a.js-pin-link","click",function(k){if(!this.guest){var j=b(this);var h=c.$nav.find(".active_item");var g=h.data("filter-id");var i=h.find(".nav-label").text();c.emitP("setDefaultFilter",g).addCallback(function(){c.pinnedFilter=g;j.hide();b("<p/>",{text:jive.browse.filter.pinConfirmation({filterName:i})}).message({style:"success"})})}k.preventDefault()});b(function(){var h=c.$nav.find(".active_item");var g=b(jive.browse.filter.activeFilterGroupItem());if(g&&h.length>0){c.$nav.find("ul:first").append(g);g.css({top:h.position().top-1+"px"})}})};this.activate=function(c,d){if(this.active!=c){this.activateFilter(c);this.active=c}if(this.activeNestedFilter!=d){this.activateNestedFilter(d);this.activeNestedFilter=d}};a.activateFilter=function(f){var c=this.$nav.find('li.js-browse-filter-group-item[data-filter-id="'+f+'"]'),d=this.$nav.find(".active_item"),e=this.$nav.find(".js-pin-link");if(c.length>0){d.find("strong span").unwrap();c.find("span.nav-label").wrap("<strong/>");e.hide();d.removeClass("active_item");c.addClass("active_item");if(!this.guest&&(String(f)!=this.pinnedFilter)){e.show()}else{e.hide()}if(!jive.Filters.isLegacyBrowser()){this.getRibbon().animate({top:c.position().top+"px"},150)}else{this.getRibbon().css("top",c.position().top)}}};a.activateNestedFilter=function(d){var c=this.$nav.find('li.js-browse-filter-group-item[data-filter-id="'+d+'"]');this.$nav.find(".active_nested_item").removeClass("active_nested_item");if(d){c.addClass("active_nested_item")}this.$nav.find(".js-clear-nav").toggle(c.length>0)};a.getRibbon=function(){var c=this.$nav.find(".active");return c};a.lastStateSwitcher=function(){var f=this.$nav.find(".active_item"),d=f.attr("data-filter-id"),e=this.$nav.find(".active_nested_item").attr("data-filter-id"),c=this;return function(){c.activate(d,e)}}});