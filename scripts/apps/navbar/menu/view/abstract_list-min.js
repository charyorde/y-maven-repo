jive.namespace("Navbar.Menu");jive.Navbar.Menu.AbstractListView=jive.AbstractView.extend(function(a,b){this.init=function(d,f,e){var c=this;c.$menu=$j(f);c.$button=$j(d);c.menuOpts=e||{};c.popoverOpen=false;c.$button.click(function(g){if(!c.popoverOpen){c.$button.addClass("active");c.showSpinner();if(c.spinning){c.spinning=false;c.openPopover();c.spinning=true}c.emitP("toggle").addCallback(function(h){c.data=h||c.data;c.render(c.data);c.openPopover()}).always(function(){c.hideSpinner()})}g.preventDefault()})};this.render=jive.oo._abstract;a.setContent=function(c,d){this.content=$j(c);if(this.popoverOpen){this.$menu.trigger("popover.html",[this.content,d])}else{this.$menu.children().remove();this.$menu.append(this.content);if(d){d()}}};this.getContent=function(){this.content=this.content||this.$menu.children();return this.content};this.close=function(){this.$menu.trigger("close")};a.createSpinner=function(){if(!this.popoverOpen){this.spinner=new jive.loader.LoaderView();this.setContent(this.spinner.getContent());this.openPopover()}else{b.createSpinner.call(this)}this.spinning=true};a.destroySpinner=function(){this.spinning=false;b.destroySpinner.call(this);if(this.spinner){this.spinner.destroy()}};a.openPopover=function(){var c=this;if(!c.popoverOpen&&!c.spinning){c.$button.addClass("active");c.$menu.popover($j.extend({context:c.$button,onClose:function(){c.$button.removeClass("active");c.popoverOpen=false},onLoad:function(){c.$menu.trigger("navbarPopoverLoad")}},c.menuOpts));c.popoverOpen=true}}});