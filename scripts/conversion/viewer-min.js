jive.namespace("conversion");jive.conversion.Viewer=function(c){c=c||{};var q=c.viewerShown||false;var n=c.viewerHeight||600;var k=c.viewerCutoff||5;var s=c.pollIncrement||3000;var l=c.stepMessage;var a=c.stepDoc;var p=c.stepPreview;var i=c.stepSub;var g=c.viewerURL;var h=c.pbType;var d=0;var f=c.statusURL;var b;function o(t){$j("#jive-oi-conversion-step").text(l.replace("{0}",t))}function j(v,u,t){return v.replace("{0}",u).replace("{1}",t)}function r(){if(q){return}if($j("#docverse-viewer-holder").length==0&&(++d)<=50){return setTimeout(r,200)}$j("#docverse-viewer-holder").show();$j("#document-viewer-frame-holder").show().append($j("<iframe/>").attr("id","docverse-viewer-frame").attr("width","100%").attr("height",n).attr("scrolling","no").attr("frameborder","0").attr("marginheight","0").attr("marginwidth","0").attr("src",g));q=true;if(window.tabView&&$j("#jive-inlinecomments").is(":hidden")){window.tabView.setVisibility("jive-inlinecomments",true)}}function e(){b=setTimeout(m,s)}function m(){$j.ajax({type:"GET",url:f,dataType:"json",contentType:"application/json; charset=utf-8",success:function(t){if(t.converting&&!t.error){if(!t.pdfGenerated){o(a)}else{if(t.previewsGenerated<t.previewsTotal&&t.previewsGenerated>0){var u=p;u=u+j(i,t.previewsGenerated,t.previewsTotal);o(u);if(t.previewsGenerated>k||(t.previewsGenerated>0&&t.previewsGenerated==t.previewsTotal)&&!q){$j("#jive-oi-conversion-msg").hide("fast",function(){r()})}}}b=setTimeout(m,s)}else{clearTimeout(b);$j("#jive-oi-conversion-msg").hide();if(t.error||!t.pdfGenerated||(t.previewsGenerated!=t.previewsTotal&&t.previewsGenerated<k)){$j("#jive-oi-error-text").text(t.errorMessage);if(!t.reconvertable){$j("jive-oi-error-reconvert").remove()}$j("#jive-oi-failed-msg").show();if(window.tabView){window.tabView.setVisibility("jive-inlinecomments-tab",false)}}else{r()}}}})}this.checkConversionProcessing=e;this.show=r};(function(a){function d(e){if(e.contentDocument){return e.contentDocument}else{if(e.contentWindow){return e.contentWindow.document}else{if(e.document){return e.document}else{return null}}}}function c(e){d(document.getElementById("docverse-viewer-frame")).DocVerse.selectComment(e,false)}function b(){tabView.switchTo("jive-inlinecomments");jive.CommentApp.inline.refresh();return false}a.selectInlineComment=c;a.doDvSelectComment=b})(jive.conversion.Viewer);