var ImageDialog={preInit:function(){var a;tinyMCEPopup.requireLangPack();if(a=tinyMCEPopup.getParam("external_image_list_url")){document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(a)+'"><\/script>')}},init:function(b){var c=document.forms[0],a=c.elements,b=tinyMCEPopup.editor,d=b.dom,e=b.selection.getNode();tinyMCEPopup.resizeToInnerSize();TinyMCE_EditableSelects.init();if(e.nodeName=="IMG"){a.src.value=d.getAttrib(e,"src");a.insert.value=b.getLang("update");a.style.value=d.getAttrib(e,"style");if(b.settings.inline_styles){if(d.getAttrib(e,"align")){this.updateStyle("align")}}}this.changeAppearance()},insert:function(c,e){var a=tinyMCEPopup.editor,b=this,d=document.forms[0];if(d.src.value===""){if(a.selection.getNode().nodeName=="IMG"){a.dom.remove(a.selection.getNode());a.execCommand("mceRepaint")}tinyMCEPopup.close();return}b.insertAndClose()},insertAndClose:function(){var c=tinyMCEPopup.editor,g=document.forms[0],a=g.elements,b,d={},e;tinyMCEPopup.restoreSelection();if(tinymce.isWebKit){c.getWin().focus()}tinymce.extend(d,{src:a.src.value,style:a.style.value});e=c.selection.getNode();if(e&&e.nodeName=="IMG"){c.dom.setAttribs(e,d)}else{c.undoManager.add();c.execCommand("mceInsertContent",false,c.dom.createHTML("img",d),{skip_undo:1});c.undoManager.add()}tinyMCEPopup.close()},getAttrib:function(d,a){var c=tinyMCEPopup.editor,g=c.dom,b,f;if(c.settings.inline_styles){switch(a){case"align":if(b=g.getStyle(d,"float")){return b}if(b=g.getStyle(d,"vertical-align")){return b}break}}if(b=g.getAttrib(d,a)){return b}return""},fillClassList:function(e){var d=tinyMCEPopup.dom,a=d.get(e),c,b;if(c=tinyMCEPopup.getParam("theme_advanced_styles")){b=[];tinymce.each(c.split(";"),function(f){var g=f.split("=");b.push({title:g[0],"class":g[1]})})}else{b=tinyMCEPopup.editor.dom.getClasses()}if(b.length>0){a.options[a.options.length]=new Option(tinyMCEPopup.getLang("not_set"),"");tinymce.each(b,function(f){a.options[a.options.length]=new Option(f.title||f["class"],f["class"])})}else{d.remove(d.getParent(e,"tr"))}},fillFileList:function(f,c){var e=tinyMCEPopup.dom,a=e.get(f),d,b;c=window[c];if(c&&c.length>0){a.options[a.options.length]=new Option("","");tinymce.each(c,function(g){a.options[a.options.length]=new Option(g[0],g[1])})}else{e.remove(e.getParent(f,"tr"))}},resetImageData:function(){var a=document.forms[0];a.elements.width.value=a.elements.height.value=""},updateImageData:function(a,b){var c=document.forms[0];if(!b){c.elements.width.value=a.width;c.elements.height.value=a.height}this.preloadImg=a},changeAppearance:function(){var b=tinyMCEPopup.editor,c=document.forms[0],a=document.getElementById("alignSampleImg");if(a){if(b.getParam("inline_styles")){b.dom.setAttrib(a,"style",c.style.value)}else{a.align=c.align.value}}},changeHeight:function(){var b=document.forms[0],c,a=this;if(b.width.value==""||b.height.value==""){return}c=(parseInt(b.width.value)/parseInt(a.preloadImg.width))*a.preloadImg.height;b.height.value=c.toFixed(0)},changeWidth:function(){var b=document.forms[0],c,a=this;if(b.width.value==""||b.height.value==""){return}c=(parseInt(b.height.value)/parseInt(a.preloadImg.height))*a.preloadImg.width;b.width.value=c.toFixed(0)},updateStyle:function(a){var g=tinyMCEPopup.dom;var d,c,e=document.forms[0];var b=g.create("img",{style:g.get("style").value});if(tinyMCEPopup.editor.settings.inline_styles){if(a=="align"){g.setStyle(b,"float","");g.setStyle(b,"vertical-align","");c=getSelectValue(e,"align");if(c){if(c=="inline"){g.setStyle(b,"display",c);g.setStyle(b,"float","none")}else{if(c=="block"){g.setStyle(b,"display",c);g.setStyle(b,"float","none")}else{if(c=="left"||c=="right"){g.setStyle(b,"display","inline");g.setStyle(b,"float",c)}else{b.style.verticalAlign=c}}}}}g.get("style").value=g.serializeStyle(g.parseStyle(b.style.cssText))}},changeMouseMove:function(){}};ImageDialog.preInit();tinyMCEPopup.onInit.add(ImageDialog.init,ImageDialog);