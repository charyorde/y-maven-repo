(function(){tinymce.create("tinymce.plugins.JiveQuotePlugin",{getInfo:function(){return{longname:"Jive Quote Button",author:"Jive Software",authorurl:"http://www.jivesoftware.com",infourl:"http://www.jivesoftware.com/",version:"1.0"}},createControl:function(d,a){switch(d){case"jivequote":var b=a.createButton("jivequote",{title:"jivequote.link_desc",cmd:"mceJiveQuote"});return b}return""},execCommand:function(d,m,c){switch(d){case"mceJiveQuote":var k=tinyMCE.activeEditor;var b=k.selection;var g=null;var j=b.isCollapsed();k.undoManager.add();var e=k.plugins.jiveutil.findMacro("quote");g=k.plugins.jivemacros.insertMacro(k,e);if(g&&j){while(g.childNodes.length>0){g.removeChild(g.childNodes[0])}if($def(window._jive_gui_quote_text)){var a=k.getDoc().createElement("DIV");a.innerHTML=_jive_gui_quote_text;if(a.childNodes.length>0){for(i=0;i<a.childNodes.length;i++){if(a.childNodes[i].nodeType==1){var n=a.childNodes[i];var h=n.childNodes[0];while(h.childNodes.length>0){if(h.childNodes[0].className=="jive-quote-header"){var l=k.getDoc().createElement("P");l.appendChild(h.childNodes[0].childNodes[0]);g.appendChild(l);g.appendChild(k.plugins.jivemacros.createEmptyPara());h.removeChild(h.childNodes[0]);h.removeChild(h.childNodes[0]);h.removeChild(h.childNodes[0])}else{function f(p){if(p.nodeName.toLowerCase()=="a"&&p.firstChild&&p.firstChild.nodeName.toLowerCase()=="img"){p.parentNode.insertBefore(p.firstChild,p);p.parentNode.removeChild(p)}else{for(var o=0;o<p.childNodes.length;o++){f(p.childNodes[o])}}}f(h.childNodes[0]);g.appendChild(h.childNodes[0])}}}}}if(g.childNodes.length==0){g.appendChild(k.plugins.jivemacros.createEmptyPara())}}else{g.appendChild(k.plugins.jivemacros.createEmptyPara())}}else{}k.selection.select(g.nextSibling?g.nextSibling:g);k.selection.collapse(true);k.selectionUtil.normalizeSelection();setTimeout(function(){var o=g.nextSibling?g.nextSibling:g;if(o.nodeType!=1){o=o.parentNode}o.scrollIntoView()},10);k.undoManager.add();return true}return false}});tinymce.PluginManager.add("jivequote",tinymce.plugins.JiveQuotePlugin)})();