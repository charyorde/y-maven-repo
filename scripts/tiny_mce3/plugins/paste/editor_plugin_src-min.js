(function(){var d=tinymce.each,e=null,a={paste_auto_cleanup_on_paste:true,paste_block_drop:false,paste_retain_style_properties:"none",paste_strip_class_attributes:"mso",paste_remove_spans:false,paste_remove_styles:false,paste_remove_styles_if_webkit:false,paste_convert_middot_lists:true,paste_convert_headers_to_strong:false,paste_dialog_width:"450",paste_dialog_height:"400",paste_text_use_dialog:false,paste_text_sticky:false,paste_text_notifyalways:false,paste_text_linebreaktype:"p",paste_text_replacements:[[/\u2026/g,"..."],[/[\x93\x94\u201c\u201d]/g,'"'],[/[\x60\x91\x92\u2018\u2019]/g,"'"]]};function b(f,g){return f.getParam(g,a[g])}function c(h){var j=0;var g=16;var f=[];function i(p,r,n){var m="00000000"+r.toString(16);m=m.substring(m.length-8);var k=[];n=Math.min(n,p.length-r);for(var l=0;l<n;++l){var q="00"+p.charCodeAt(r+l).toString(16);k.push(q.substring(q.length-2));if(l>0&&l%8==0){k.push("")}}var o=p.substr(r,n).replace(/[\x00-\x1f]/g,".");return m+"  "+k.join(" ")+"  |"+o+"|"}while(j<h.length){f.push(i(h,j,g));j+=g}return f.join("\n")}tinymce.create("tinymce.plugins.PastePlugin",{init:function(f,g){var h=this;h.editor=f;h.url=g;h.onPreProcess=new tinymce.util.Dispatcher(h);h.onPostProcess=new tinymce.util.Dispatcher(h);h.onPasteComplete=new tinymce.util.Dispatcher(h);h.onPreProcess.add(h._preProcess);h.onPostProcess.add(h._postProcess);h.onPreProcess.add(function(k,l){f.execCallback("paste_preprocess",k,l)});h.onPostProcess.add(function(k,l){f.execCallback("paste_postprocess",k,l)});f.pasteAsPlainText=false;function j(m,k){var l=f.dom;f.undoManager.add();h.onPreProcess.dispatch(h,m);m.node=l.create("div",0,m.content);h.onPostProcess.dispatch(h,m);m.content=f.serializer.serialize(m.node,{getInner:1,forced_root_block:""});m.content=m.content.replace(/\n/gi,"").replace(/\r/gi,"");if((!k)&&(f.pasteAsPlainText)){h._insertPlainText(f,l,m.content);if(!b(f,"paste_text_sticky")){f.pasteAsPlainText=false;f.controlManager.setActive("pastetext",false)}}else{if(/<(p|h[1-6]|ul|ol)/.test(m.content)){h._insertBlockContent(f,l,m.content)}else{h._insert(m.content,1)}}h.onPasteComplete.dispatch(h,f);f.undoManager.add()}f.addCommand("mceInsertClipboardContent",function(k,l){j(l,true)});if(!b(f,"paste_text_use_dialog")){f.addCommand("mcePasteText",function(l,k){var m=tinymce.util.Cookie;f.pasteAsPlainText=!f.pasteAsPlainText;f.controlManager.setActive("pastetext",f.pasteAsPlainText);if((f.pasteAsPlainText)&&(!m.get("tinymcePasteText"))){if(b(f,"paste_text_sticky")){f.windowManager.alert(f.translate("paste.plaintext_mode_sticky"))}else{f.windowManager.alert(f.translate("paste.plaintext_mode_sticky"))}if(!b(f,"paste_text_notifyalways")){m.set("tinymcePasteText","1",new Date(new Date().getFullYear()+1,12,31))}}})}f.addButton("pastetext",{title:"paste.paste_text_desc",cmd:"mcePasteText"});f.addButton("selectall",{title:"paste.selectall_desc",cmd:"selectall"});function i(u){var o,r,l,v,m=f.selection,q=f.dom,s=f.getBody(),k,t;if(u.clipboardData||q.doc.dataTransfer){if(f.pasteAsPlainText){t=(u.clipboardData||q.doc.dataTransfer).getData("Text");u.preventDefault();j({content:t.replace(/\r?\n/g,"<br />")});return}}if(q.get("_mcePaste")){return}o=q.add(s,"div",{id:"_mcePaste","class":"mcePaste","data-mce-bogus":"1"},"\uFEFF\uFEFF");if(s!=f.getDoc().body){k=q.getPos(f.selection.getStart(),s).y}else{k=s.scrollTop+q.getViewPort().y}q.setStyles(o,{position:"absolute",left:-10000,top:k,width:1,height:1,overflow:"hidden"});if(tinymce.isIE){v=m.getRng();l=q.doc.body.createTextRange();l.moveToElementText(o);l.execCommand("Paste");q.remove(o);if(o.innerHTML==="\uFEFF\uFEFF"){f.execCommand("mcePasteWord");u.preventDefault();return}m.setRng(v);m.setContent("");setTimeout(function(){j({content:o.innerHTML})},0);return tinymce.dom.Event.cancel(u)}else{function p(n){n.preventDefault()}q.bind(f.getDoc(),"mousedown",p);q.bind(f.getDoc(),"keydown",p);r=f.selection.getRng();o=o.firstChild;l=f.getDoc().createRange();l.setStart(o,0);l.setEnd(o,2);m.setRng(l);window.setTimeout(function(){var w="",n=q.select("div.mcePaste");if(n.length>1){n=q.select("div.mcePaste:not(:first)")}d(n,function(y){var x=y.firstChild;if(x&&x.nodeName=="DIV"&&x.style.marginTop&&x.style.backgroundColor){q.remove(x,1)}d(q.select("div.mcePaste",y),function(z){q.remove(z,1)});d(q.select("span.Apple-style-span",y),function(z){q.remove(z,1)});d(q.select("span.Apple-tab-span",y),function(A){var z=A.innerHTML;while(z!=z.replace("\t","     ")){z=z.replace("\t","     ")}A.parentNode.insertBefore(A.ownerDocument.createTextNode(z),A);q.remove(A,1)});d(q.select("br[_mce_bogus]",y),function(z){q.remove(z)});w+=y.innerHTML+"<br/>"});d(n,function(x){q.remove(x)});d(q.select("div.mcePaste"),function(x){q.remove(x)});if(r){m.setRng(r)}j({content:w});q.unbind(f.getDoc(),"mousedown",p);q.unbind(f.getDoc(),"keydown",p)},0)}}if(b(f,"paste_auto_cleanup_on_paste")){if(tinymce.isOpera||/Firefox\/2/.test(navigator.userAgent)){f.onKeyDown.add(function(k,l){if(((tinymce.isMac?l.metaKey:l.ctrlKey)&&l.keyCode==86)||(l.shiftKey&&l.keyCode==45)){i(l)}})}else{f.onPaste.addToTop(function(k,l){return i(l)})}}if(b(f,"paste_block_drop")){f.onInit.add(function(){f.dom.bind(f.getBody(),["dragend","dragover","draggesture","dragdrop","drop","drag"],function(k){k.preventDefault();k.stopPropagation();return false})})}if(b(f,"paste_legacy_support")){h._legacySupport()}},getInfo:function(){return{longname:"Paste text/word",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/paste",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_preProcess:function(z,s){var j=this.editor,y=s.content,m=tinymce.grep,t=tinymce.explode,v=tinymce.trim,x,n;function r(h){d(h,function(o){if(o.constructor==RegExp){y=y.replace(o,"")}else{y=y.replace(o[0],o[1])}})}function A(o,h){h.push("<tr>");d(o,function(B){h.push("<td>");h.push(B);h.push("</td>")});h.push("</tr>")}(function(){var C=/\x0a\x20((?:\x0a\x20\x20[^<\x0a]*)+)\x0a\x20/g;var o=C.exec(y);if(o){var h=[y.substring(0,o.index),"<table><tbody>"];C.lastIndex=0;var B=o.index;y.replace(C,function(G,H,F,E){if(F>B){h.push("</tbody></table>");h.push(E.substring(B,F));h.push("<table><tbody>")}B=F+G.length;var D=H.split(/\x0a\x20\x20/).slice(1);A(D,h);return G});h.push(y.substring(B));y=h.join("")}})();(function(){var B="\t";if(tinymce.isGecko){B="(?:(?:&nbsp;){3} )"}else{if(tinymce.isWebKit){B="(?: *\t)"}else{if(tinymce.isIE){return}}}var o=new RegExp("^(?:[^<>]*?"+B+")+[^<>]*<br */?>","i");var h=new RegExp("(?:[^<>]*?"+B+")+[^<>]*","i");var E=new RegExp(B,"i");if(o.test(y)){function D(F,H){H.push("<table><tbody>");h.lastIndex=0;while(F.length&&h.test(F[0])){var G=F.shift().split(E);A(G,H)}H.push("</tbody></table>")}function C(H){var F=H.split(/<br *\/?>/ig);var G=[];while(F.length){h.lastIndex=0;if(h.test(F[0])){D(F,G)}else{G.push(F.shift());G.push("<br />")}}return G.join("")}y=C(y)}})();y=y.replace(/<style([^>]*)>([^<]*?)<\/style>/gi,"");r([[/^([^<]+)<br\s*\/?>$/gi,"$1"]]);r([[/(<[a-z][^>]*)\sid="?_mcePaste"?/gi,"$1"]]);(function(){var h=/^https?:\/\/(?:[^:]+:[^@])?[\w\.]+(?::\d+)?\S*$/;var o=/<br[^>]*>/;if(h.test(y)&&!o.test(y)){y="<a href='"+y+"' title='"+y+"' class='loading'>"+y+"</a>"}})();if(/class="?Mso|style="[^"]*\bmso-|w:WordDocument/i.test(y)||s.wordContent){s.wordContent=true;r([/^\s*(?:&nbsp;)+/gi,/(?:&nbsp;|<br[^>]*>)+\s*$/gi]);if(b(j,"paste_convert_headers_to_strong")){y=y.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>")}if(b(j,"paste_convert_middot_lists")){r([[/<!--\[if !supportLists\]-->/gi,"$&__MCE_ITEM__"],[/(<span[^>]+(?:mso-list:|:\s*symbol|:\s*wingdings)[^>]+>)/gi,"$1__MCE_ITEM__"],[/<span[^>]+mso-list:\s+Ignore[^>]+>/gi,'<span class="pasted-list-info">']]);do{var w=y;r([[/<span[^>]*>((?:&nbsp;|\s|\u00a0)*)<\/span>/gi,"$1"],[/<span[^>]+(?:mso-list:|:\s*symbol|:\s*wingdings)[^>]+>(__MCE_ITEM__)([^<]*?)<\/span>/gi,"$1$2"],[/(__MCE_ITEM__)(?:&nbsp;|\s|\u00a0)*/gi,"$1"]])}while(w!=y)}r([/<!--[\s\S]+?-->/gi,/<(?:!|script[^>]*>.*?<\/script(?=[>\s])|\/?(?:\?xml(?::\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"]]);do{x=y.length;y=y.replace(/(<[a-z][^>]*\s)(?:id|name|language|type|on\w+|\w+:\w+)=(?:"[^"]*"|\w+)\s?/gi,"$1")}while(x!=y.length);y=y.replace(/<strong><span([^>]*)font-weight:([^<;"]*)normal[;]?([^>]*)>([^<]*?)<\/span><\/strong>/gi,"<span$1$3>$4</span>");y=y.replace(/<strong><span([^>]*)font-weight:([^<;"]*)bold[er]?[;]?([^>]*)>([^<]*?)<\/span><\/strong>/gi,"<strong><span$1$3>$4</span></strong>");if(b(j,"paste_retain_style_properties").replace(/^none$/i,"").length==0){y=y.replace(/<\/?span[^>]*>/gi,"")}else{r([[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(o,h){return(h.length>0)?h.replace(/./," ").slice(Math.floor(h.length/2)).split("").join("\u00a0"):""}]])}}r([[/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,function k(E,I,h){var B=[],D=0,H=t(v(h).replace(/&quot;/gi,"'"),";");var o=false;var G=false;var F=false;d(H,function C(Q){var J,M,L=t(Q,":");function N(S){return S+(((S!=="0")&&(/\d$/.test(S)))?"px":"")}if(L.length==2){J=L[0].toLowerCase();M=L[1].toLowerCase();var R=I.toLowerCase();switch(J){case"text-decoration":if(M!="none"){B[D++]=J+":"+M}return;case"font-style":if((R.indexOf("<em")===0||R.indexOf("<i")===0)&&v(M)=="normal"){F=true}else{if((R.indexOf("<em")===0||R.indexOf("<i")===0)&&v(M)=="oblique"){}else{B[D++]=J+":"+M}}return;case"font-weight":if((R.indexOf("<strong")===0||R.indexOf("<b")===0)&&v(M)=="normal"){F=true}else{if((R.indexOf("<strong")===0||R.indexOf("<b")===0)&&v(M).indexOf("bold")>=0){}else{B[D++]=J+":"+M}}return;case"list-style":case"list-style-type":case"list-style-image":case"list-style-position":if(R.indexOf("<ul")===0||R.indexOf("<ol")===0||R.indexOf("<li")===0){B[D++]=J+":"+M}return;case"border-collapse":return;case"border":case"border-width":case"border-style":case"border-color":if(R.indexOf("<table")===0||R.indexOf("<tr")===0||R.indexOf("<td")===0||R.indexOf("<th")===0||R.indexOf("<img")===0){if(M!="inherit"&&M!="initial"){M=M.replace(/(?:^|\s*)-moz[-\w]+\b/g,"");B[D++]=J+":"+M}}return;case"margin":case"margin-left":case"margin-right":case"margin-top":case"margin-bottom":case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":M=M.replace(/^0(?:[\w]+)/gi,"0").replace(/(?:\s)0(?:[\w]+)/gi," 0").replace(/(?:\s)0\.00(?:[\d|\w]+)/gi," 0");M=M.replace(/^[0\s]*$/gi,"0");if(M!="0"){J=J.replace(/^mso-|-alt$/g,"").toLowerCase();if(J=="margin-left"&&v(R)=="<p"){var K=parseFloat(M);var O=M.replace(/[\d\.]*([^\d]*)$/g,"$1").toLowerCase();if(O=="in"){K=K*90;B[D++]="padding-left:"+K+"px";return}}else{if(L[1]!="0"&&L[1]!="initial"){if(R.indexOf("<table")===0||R.indexOf("<tr")===0||R.indexOf("<td")===0||R.indexOf("<th")===0||R.indexOf("<img")===0){if(M.indexOf("-")!==0){B[D++]=J+":"+M}}else{B[D++]=J+":"+M}}}}return;case"mso-list":o=M.replace(/.*level(\d*).*/gi,"$1");return;case"mso-bidi-theme-font":G=true;return;case"horiz-align":case"text-align":B[D++]="text-align:"+M;return;case"text-indent":B[D++]="text-indent:"+M;return;case"vert-align":B[D++]="vertical-align:"+M;return;case"color":case"font-color":case"mso-foreground":if(M!="transparent"){B[D++]="color:"+M}return;case"mso-background":case"mso-highlight":B[D++]="background:"+M;return;case"background-color":if(M!="transparent"&&M!="rgb(255, 255, 255)"){B[D++]="background-color:"+M}return;case"background-position":case"background-repeat":if(M!="initial initial"&&M!="repeat repeat"&&M!="0px 0px"){B[D++]="background-position:"+M}return;case"background-image":return;case"font-size":if(M!="1em"){B[D++]="font-size:"+M}return;case"mso-default-height":if(M!="0px"){B[D++]="min-height:"+N(M)}return;case"mso-default-width":if(M!="0px"){B[D++]="min-width:"+N(M)}return;case"mso-padding-between-alt":B[D++]="border-collapse:separate;border-spacing:"+N(M);return;case"text-line-through":if((M=="single")||(M=="double")){B[D++]="text-decoration:line-through"}return;case"mso-zero-height":if(M=="yes"){B[D++]="display:none"}return}if(/^(?:mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!decor|trans)|top-bar|version|vnd|word-break)/.test(J)){return}if(R.indexOf("<p")===0&&(J=="min-height"||J=="height")){return}L[1]=L[1].replace(/^0(?:[\w]+)/gi,"0").replace(/(?:\s)0(?:[\w]+)/gi," 0").replace(/(?:\s)0.00(?:[\d|\w]+)/gi," 0");L[1]=L[1].replace(/^[0\s]*$/gi,"0");var P=b(j,"paste_retain_style_properties");if((tinymce.is(P,"string"))&&(P!=="all")&&(P!=="*")){P=tinymce.explode(P.replace(/^none$/i,""))}else{P=[]}if((!P.length||tinymce.inArray(P,J))>=0&&L[1]!="0"&&L[1]!="initial"){B[D++]=J+":"+L[1]}}});I=I+(G?" jive-list-ol='1'":"")+(o?" jive-list-info='"+o+"'":"")+(F?" jive-remove-tag='1'":"");if(D>0){return I+' style="'+B.join(";")+'"'}else{return I}}]]);if(b(j,"paste_convert_headers_to_strong")){r([[/<h[1-6][^>]*>/gi,"<p><strong>"],[/<\/h[1-6][^>]*>/gi,"</strong></p>"]])}n=b(j,"paste_strip_class_attributes");if(n!=="none"){function q(B,o){if(n==="all"){return""}var h=m(t(o.replace(/^(["'])(.*)\1$/,"$2")," "),function(C){return(/^(?!mso)/i.test(C))});return h.length?' class="'+h.join(" ")+'"':""}y=y.replace(/ class="([^"]+)"/gi,q);y=y.replace(/ class=([\w-]+)/gi,q)}if(b(j,"paste_remove_spans")){y=y.replace(/<\/?span[^>]*>/gi,"")}r([[/<li[^>]*>(.*)<\/li>/gi,function(C,o){var D=C.substr(0,C.indexOf(">")+1);var h=C.substr(D.length+o.length);o=o.replace(/<p([^>]*)>(.*?)<\/p>/gi,"<span$1>$2</span>");o=o.replace(/<div([^>]*)>(.*?)<\/div>/gi,"<span$1>$2</span>");o=o.replace(/<br><\/span>/gi,"</span>");do{var B=o;o=o.replace(/<span[^>]*><\/span>/gi,"")}while(B!=o);return D+o+h}]]);y=y.replace(/<meta[^>]*>/gi,"");y=y.replace(/<\/meta>/gi,"");y=y.replace(/<br[^>]*>$/i,"");var g=/^<pre[^>]*>([\s\S]*)<\/pre[^>]*>$/i;var l=g.exec(y);if(l!=null){y=l[1].replace(/\n/g,"<br />")}else{y=y.replace(/\r/gi,"\n");var f=y.split("\n");var u=[];d(f,function(h){u.push(v(h))});y=u.join(" ")}y=y.replace(/<title([^>]*)>([^<]*?)<\/title>/gi,"");y=y.replace(/\n/gi,"").replace(/\r/gi,"");var i=y;do{y=i;i=y.replace(/<span>(.*?)<\/span>/gi,"$1")}while(i!=y);y=y.replace(/<pre>/gi,"<pre class='jive-pre'>");y=y.replace(/<div><br><\/div>/gi,"");y=y.replace(/<div([^>]*)>(\s?)<\/div>/gi,"");y=y.replace(/<li[^>]*>(.*?)<\/li>/gi,"<li>$1</li>");y=y.replace(/<ul[^>]*>(.*?)<\/ul>/gi,"<ul>$1</ul>");y=y.replace(/<li[^>]*>(.*?)<p[^>]*>(.*?)<\/li>/gi,"<li>$1$2</li>");y=y.replace(/<li[^>]*>(.*?)<\/p>(.*?)<\/li>/gi,"<li>$1$2</li>");y=y.replace(/<li><p>(.*?)<\/p><\/li>/gi,"<li>$1</li>");y=y.replace(/<ul><\/ul>/gi,"");y=y.replace(/<ol><\/ol>/gi,"");y=y.replace(/>([\s|^\u00a0]*)<td/gi,"><td");y=y.replace(/<\/td>([\s|^\u00a0]*)</gi,"</td><");y=y.replace(/<\/li>([\s&&[^\u00a0]]*)<\/ul>/gi,"</li></ul>");y=y.replace(/<\/li>([\s&&[^\u00a0]]*)<\/ol>/gi,"</li></ol>");y=y.replace(/<ul>([\s&&[^\u00a0]]*)<li>/gi,"<ul><li>");y=y.replace(/<ol>([\s&&[^\u00a0]]*)<li>/gi,"<ol><li>");y=y.replace(/<\/li>([\s&&[^\u00a0]]*)<li>/gi,"<li><li>");var p="(?:H[1-6R]|P|DIV|ADDRESS|PRE|FORM|TABLE|TBODY|THEAD|TFOOT|TH|TR|TD|LI|OL|UL|CAPTION|BLOCKQUOTE|CENTER|DL|DT|DD|DIR|FIELDSET|NOSCRIPT|MENU|ISINDEX|SAMP)";y=y.replace(new RegExp("(</?"+p+"[^>]*>)\\s+(?=<"+p+")","gi"),"$1");y=y.replace(new RegExp("(</"+p+"[^>]*>)\\s+(?=</"+p+")","gi"),"$1");y=y.replace(/> /gi,">&nbsp;");y=y.replace(/ </gi,"&nbsp;<");r([[/<div([^>]*)>((.(?!<div))*?)<\/div>/gi,function(B,C,h){var o=h.toLowerCase();if(o.indexOf("<ul")>=0||o.indexOf("<ol")>=0||o.indexOf("<blockquote")>=0||o.indexOf("<p")>=0){return h}return B}]]);y=y.replace(/<div([^>]*)>(.*?)<\/div>/gi,"<p$1>$2</p>");y=y.replace(/<\/strong><strong(?:\s*)>/gi,"");y=y.replace(/<\/b><b(?:\s*)>/gi,"");y=y.replace(/<\/u><u(?:\s*)>/gi,"");y=y.replace(/<\/em><em(?:\s*)>/gi,"");y=y.replace(/<\/i><i(?:\s*)>/gi,"");y=y.replace(/(_jivemacro_uid_\d+)/gi,"");y=y.replace(/(_jivemacro_uid=['"][^"']*['"])/gi,"");y=y.replace(/<br class="Apple-interchange-newline">/gi,"");s.content=y},_postProcess:function(F,v){var q=this,h=q.editor,C=h.dom,f;q._removeNodes(F,v);q._fixOrphanLIs(F,v);if(v.wordContent){d(C.select("a",v.node),function(i){if(!i.href||i.href.indexOf("#_Toc")!=-1){C.remove(i,1)}});if(b(h,"paste_convert_middot_lists")){q._convertLists(F,v)}d(C.select("*",v.node),function(i){if(i.nodeName=="SPAN"&&!i.className&&!C.getAttrib(i,"style")){C.remove(i,true)}})}if(b(h,"paste_remove_styles")||(b(h,"paste_remove_styles_if_webkit")&&tinymce.isWebKit)){d(C.select("*[style]",v.node),function(i){i.removeAttribute("style");i.removeAttribute("data-mce-style")})}else{if(tinymce.isWebKit){d(C.select("*",v.node),function(i){if(i.getAttribute("data-mce-style")){i.setAttribute("style",i.getAttribute("data-mce-style"))}i.removeAttribute("data-mce-style")})}}for(var B=0;B<v.node.childNodes.length;B++){var D=v.node.childNodes[B];var l=D.nodeType==3;var r=/^[\s\u00a0]*$/gi.test(D.nodeValue);if(l&&r){D.parentNode.removeChild(D);B--}else{break}}for(var B=v.node.childNodes.length-1;B>=0;B--){var D=v.node.childNodes[B];var l=D.nodeType==3;var r=/^[\s\u00a0]*$/gi.test(D.nodeValue);if(l&&r){D.parentNode.removeChild(D)}else{break}}if(v.node.childNodes.length>1){var y=false;var u=new Array();var g=v.node.firstChild;var k=0;while(g!=null){var j=g.nextSibling;var m=g.nodeName.toLowerCase();var x=j?j.nodeName.toLowerCase():null;if(g.nodeType==3||!C.isBlock(g)&&m!="br"){if(j&&x=="p"&&j.innerHTML.length==0){j.parentNode.removeChild(j)}else{if(j&&x=="br"){j.parentNode.removeChild(j);y=true}}u.push(g)}else{if(m=="br"){var s=C.create("p");g.parentNode.insertBefore(s,g);s.appendChild(g);g=s;++k}}if(j&&j.nodeType==1&&C.isBlock(j)||y){if(u.length){var s=u[0].ownerDocument.createElement("p");v.node.insertBefore(s,u[0]);do{s.appendChild(u.shift())}while(u.length);g=s;++k;u=new Array()}}y=false;g=g.nextSibling}if(u.length&&k>0){var s=u[0].ownerDocument.createElement("p");v.node.insertBefore(s,u[0]);do{s.appendChild(u.shift())}while(u.length)}}d(C.select("table",v.node),function(o){var G=o.firstChild;while(G){var p=G;G=G.nextSibling;if(p.nodeType!=1){o.removeChild(p)}else{var i=p.nodeName.toLowerCase();if(i!="tbody"&&i!="tr"){o.removeChild(p)}}}});function E(i,o){var t=i.firstChild;while(t){var p=t;t=t.nextSibling;if(!o.test(p.nodeName)){i.removeChild(p)}}}d(C.select("tr",v.node),function(i){E(i,/t[hd]/i)});d(C.select("tbody",v.node),function(i){E(i,/tr/i)});var w=C.select("p p",v.node);d(w,function(o){var i=C.getParent(o,"p",v.node);C.split(i,o)});d(C.select("a.jive_macro",v.node),function(i){if(C.getAttrib(i,"href")){C.setAttrib(i,"href","javascript:;")}if(!C.getAttrib(i,"jivemacro")){var o=i.className.split(/\s+/);d(o,function(p){if(p.indexOf("jive_macro_")===0){var t=p.substr("jive_macro_".length);C.setAttrib(i,"jivemacro",t)}})}});if(h.plugins.jiveimage){d(C.select("img",v.node),function(i){C.addClass(i,"jiveImage");if(/^(?:data|blob):/.test(i.src)){C.addClass(i,"toUpload");C.setStyles(i,{"max-width":"1200px","max-height":"900px"})}else{if(/^(?:file|webkit-fake-url):/.test(i.src)){C.remove(i)}}})}if(v.node.childNodes.length==1&&v.node.firstChild.nodeName.toLowerCase()=="a"){var z=v.node.firstChild;if(!(C.hasClass(z,"jive_macro")||C.getAttrib(z,"jivemacro"))){var A=C.getAttrib(z,"href");var n=h.convertURL(tinymce.trim(z.textContent));if(A==n||new RegExp(encodeURIComponent(A)+"$").test(encodeURIComponent(n))){C.addClass(z,"loading")}}}if(v.node.childNodes.length==1&&v.node.firstChild.nodeName.toLowerCase()=="p"){C.remove(v.node.firstChild,true)}h.addVisual(v.node)},_fixOrphanLIs:function(i,g){var k=i.editor.dom,j,n,f=-1,h,p=[],m,l;if(i.editor.selection.getNode().nodeName.toLowerCase()!=="li"){d(k.select("li",g.node),function(o){if(o.parentNode.nodeName.toLowerCase()!="ul"&&o.parentNode.nodeName.toLowerCase()!="ol"){var q=o.ownerDocument.createElement("ul");o.parentNode.insertBefore(q,o);q.appendChild(o)}})}},_removeNodes:function(i,g){var k=i.editor.dom,j,n,f=-1,h,p=[],m,l;d(k.select("[jive-remove-tag=1]",g.node),function(o){if(o.nodeType==1){while(o.childNodes.length){o.parentNode.insertBefore(o.childNodes[0],o)}o.parentNode.removeChild(o)}})},_convertLists:function(k,h){var m=k.editor.dom,l,r,f=-1,j,s=[],p,n;function i(u){var t=m.create(u.listType),o="list-style-type: "+u.subType;if(tinymce.isIE){t.style.setAttribute("cssText",o)}else{t.setAttribute("style",o)}return t}function q(w){var v=m.select(".pasted-list-info",w);var x;if(v.length>0){x=v[0].textContent}else{x=w.innerHTML.replace(/<\/?\w+[^>]*>/gi,"").replace(/&nbsp;/g,"\u00a0")}var o={isListItem:/__MCE_ITEM__+/.test(x)||/^(\d)+\./.test(x)||/^v\s+/.test(x)||/^[a-z]+\./i.test(x)};var u=null;if(m.select("span[jive-list-ol=1]",w).length){u="ol"}if(m.select("span[jive-list-ul=1]",w).length){u="ul"}if(o.isListItem){var t=x.match(/^[^\s]+/)[0].replace(/^(?:__MCE_ITEM__)*/,"");if(!o.subType){o.subType=(function(){if(/^0\d/.test(t)){return"decimal-leading-zero"}else{if(/^\d/.test(t)){return"decimal"}else{if(/^[i]/.test(t)){return"lower-roman"}else{if(/^[I]/.test(t)){return"upper-roman"}else{if(/^v/.test(t)&&(!u||u=="ul")){return"disc"}else{if(/^o/.test(t)&&(!u||u=="ul")){return"circle"}else{if(/^[a-z]/.test(t)){return"lower-alpha"}else{if(/^[A-Z]/.test(t)){return"upper-alpha"}else{if(/^[\u03b1-\u03c8]/.test(t)){return"lower-greek"}else{return"disc"}}}}}}}}}})()}o.listType=/disc|circle|square/.test(o.subType)?"ul":"ol"}return o}d(m.select("p",h.node),function(y){var u,v,o,t,x=q(y);if(x.isListItem){var w=parseFloat(y.getAttribute("jive-list-info")||0);if(w>f){s.push(w)}if(!l||(x.listType!=p&&w==f)){l=i(x);m.insertAfter(l,y)}else{if(w>f){var z=l;l=i(x);z.appendChild(l)}else{if(w<f){o=tinymce.inArray(s,w);t=m.getParents(l.parentNode,"ol,ul");l=t[t.length-1-o]||l;if(l.nodeName.toLowerCase()==x.listType){}else{var z=l;l=i(x);m.insertAfter(l,z)}}}}d(m.select(".pasted-list-info",y),function(A){m.remove(A)});d(m.select("span",y),function(B){if(B.childNodes.length==0){m.remove(B);return}var A=B.innerHTML.replace(/<\/?\w+[^>]*>/gi,"");if(x.listType=="ul"&&/^.?\s*(&nbsp;|\u00a0)+\s*/.test(A)){m.remove(B)}else{if(/^__MCE_ITEM__[\s\S]*\w+[\.|\)|:]?(&nbsp;|\u00a0)+\s*/.test(A)){m.remove(B)}}});if(/alpha$/.test(x.subType)){y.innerHTML=y.innerHTML.replace(/^[a-z]+\.(\s|\u00a0|&nbsp;)+/i,"")}v=y.innerHTML;if(x.listType=="ul"){v=v.replace(/(__MCE_ITEM__)+.?\s*(&nbsp;|\u00a0|\u00b7)+\s*/,"")}else{v=v.replace(/(__MCE_ITEM__)+\s*\w+[\.|\)|:]?(&nbsp;|\u00a0)+\s*/,"").replace(/^\d+\.(\s|\u00a0|&nbsp;)+/,"");v=v.replace(/__MCE_ITEM__(\w)+\.\s?/,"")}r=l.appendChild(m.create("li",0,v));m.remove(y);f=w;p=x.listType}else{l=f=0}});n=h.node.innerHTML;n=n.replace(/__MCE_ITEM__/g,"");do{var g=n;n=n.replace(/<(\w+)[^>]*?>\s*<\/[^>]*>/gi,"")}while(g!=n);h.node.innerHTML=n},_insertBlockContent:function(h,v,u){var g,j,t=h.selection,k,i,w,m,f,q="mce_paste_marker";function r(A){var l;if(tinymce.isIE){l=h.getDoc().body.createTextRange();try{l.moveToElementText(A)}catch(z){try{l.moveToElementText(A.parentNode)}catch(y){}}l.collapse(false);l.select()}else{t.select(A,1);t.collapse(false)}}function n(y){var l=v.select("."+y);if(l&&l.length>0){return l[0]}return null}function x(l){if(v.isEmpty(l)){return true}var y=l.firstChild;while(y){if(y.nodeType==1&&v.isEmpty(y)&&y.nodeName.toLowerCase()!="img"){return true}y=y.firstChild}return false}var p=h.selectionUtil.atStartOf(t.getNode());this._insert('<span class="'+q+'"></span>',1);j=n(q);g=v.getParent(j,"p,h1,h2,h3,h4,h5,h6,ul,ol,th,td");if(h.dom.getParent(t.getNode(),"li")){var o=h.dom.getParent(t.getNode(),"li");var s=h.dom.getParent(o,"ol,ul");if(p){s.insertBefore(j,o);g=s}else{if(h.selectionUtil.atEndOf(o)){s.insertBefore(j,o.nextSibling);g=s}}if(x(o)){s.removeChild(o)}}if(g&&!/TD|TH/.test(g.nodeName)){j=v.split(g,j)}d(v.create("div",0,u).childNodes,function(l){k=l.cloneNode(true);j.parentNode.insertBefore(k,j)});r(k);d(v.select("."+q),function(l){v.remove(l)});i=t.getStart();w=v.getViewPort(h.getWin());m=h.dom.getPos(i).y;f=i.clientHeight;if(m<w.y||m+f>w.y+w.h){h.getWin().scrollTo(0,m<w.y?m:m-w.h+f)}},_insert:function(i,f){var g=this.editor,j=g.selection.getRng();if(!g.selection.isCollapsed()&&j.startContainer!=j.endContainer){g.getDoc().execCommand("Delete",false,null)}g.execCommand("mceInsertContent",false,i,{skip_undo:f})},_insertPlainText:function(k,y,x){var u,v,m,l,s,f,q,g,o=k.getWin(),A=k.getDoc(),t=k.selection,n=tinymce.is,z=tinymce.inArray,j=b(k,"paste_text_linebreaktype"),p=b(k,"paste_text_replacements");function r(h){d(h,function(i){if(i.constructor==RegExp){x=x.replace(i,"")}else{x=x.replace(i[0],i[1])}})}if((typeof(x)==="string")&&(x.length>0)){if(!e){e=("34,quot,38,amp,39,apos,60,lt,62,gt,"+k.serializer.settings.entities).split(",")}if(/<(?:p|br|h[1-6]|ul|ol|dl|table|t[rdh]|div|blockquote|fieldset|pre|address|center)[^>]*>/i.test(x)){r([/[\n\r]+/g])}else{r([/\r+/g])}r([[/<\/(?:p|h[1-6]|ul|ol|dl|table|div|blockquote|fieldset|pre|address|center)>/gi,"\n\n"],[/<br[^>]*>|<\/tr>/gi,"\n"],[/<\/t[dh]>\s*<t[dh][^>]*>/gi,"\t"],/<[a-z!\/?][^>]*>/gi,[/&nbsp;/gi," "],[/&(#\d+|[a-z0-9]{1,10});/gi,function(i,h){if(h.charAt(0)==="#"){return String.fromCharCode(h.slice(1))}else{return((i=z(e,h))>0)?String.fromCharCode(e[i-1]):" "}}],[/(?:(?!\n)\s)*(\n+)(?:(?!\n)\s)*/gi,"$1"],[/\n{3,}/g,"\n\n"],/^\s+|\s+$/g]);x=y.encode(x);if(!t.isCollapsed()){A.execCommand("Delete",false,null)}if(n(p,"array")||(n(p,"array"))){r(p)}else{if(n(p,"string")){r(new RegExp(p,"gi"))}}if(j=="none"){r([[/\n+/g," "]])}else{if(j=="br"){r([[/\n/g,"<br />"]])}else{r([/^\s+|\s+$/g,[/\n\n/g,"</p><p>"],[/\n/g,"<br />"]])}}if((m=x.indexOf("</p><p>"))!=-1){l=x.lastIndexOf("</p><p>");s=t.getNode();f=[];do{if(s.nodeType==1){if(s.nodeName=="TD"||s.nodeName=="BODY"){break}f[f.length]=s}}while(s=s.parentNode);if(f.length>0){q=x.substring(0,m);g="";for(u=0,v=f.length;u<v;u++){q+="</"+f[u].nodeName.toLowerCase()+">";g+="<"+f[f.length-u-1].nodeName.toLowerCase()+">"}if(m==l){x=q+g+x.substring(m+7)}else{x=q+x.substring(m+4,l+4)+g+x.substring(l+7)}}}k.execCommand("mceInsertRawHTML",false,x+'<span id="_plain_text_marker">&nbsp;</span>');window.setTimeout(function(){var h=y.get("_plain_text_marker"),C,i,B,w;t.select(h,false);A.execCommand("Delete",false,null);h=null;C=t.getStart();i=y.getViewPort(o);B=y.getPos(C).y;w=C.clientHeight;if((B<i.y)||(B+w>i.y+i.h)){A.body.scrollTop=B<i.y?B:B-i.h+25}},0)}},_legacySupport:function(){var g=this,f=g.editor;f.addCommand("mcePasteWord",function(){f.windowManager.open({file:CS_RESOURCE_BASE_URL+"/resources/scripts/tiny_mce3/plugins/paste/pasteword.htm",width:parseInt(b(f,"paste_dialog_width")),height:parseInt(b(f,"paste_dialog_height")),inline:1})});if(b(f,"paste_text_use_dialog")){f.addCommand("mcePasteText",function(){f.windowManager.open({file:g.url+"/pastetext.htm",width:parseInt(b(f,"paste_dialog_width")),height:parseInt(b(f,"paste_dialog_height")),inline:1})})}f.addButton("pasteword",{title:"paste.paste_word_desc",cmd:"mcePasteWord"})}});tinymce.PluginManager.add("paste",tinymce.plugins.PastePlugin)})();