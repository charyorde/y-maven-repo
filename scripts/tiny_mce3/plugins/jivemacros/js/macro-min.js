var action,orgTableWidth,orgTableHeight,dom=tinyMCEPopup.editor.dom;function editMacro(){var b=tinyMCEPopup.editor;var f=b.dom;var g=b.selection.getNode();var d=tinyMCEPopup.params.macro;var e=d.getAllowedParameters();for(var c=0;c<e.length;c++){var a=document.getElementById("_"+e[c].name);if(a.value.length>0){g.setAttribute("_"+e[c].name,a.value)}else{g.removeAttribute("_"+e[c].name)}}b.plugins.jivemacros.removeDuplicateMacros(b,b.getBody());tinyMCEPopup.close()}function init(){tinyMCEPopup.resizeToInnerSize();var l=tinyMCEPopup.editor;var d=tinyMCEPopup.params.macro;var g=l.dom;var n=l.selection.getNode();var r=document.getElementById("macrotable");var e=d.getAllowedParameters();for(var h=e.length-1;h>=0;h--){var c=e[h];var s=r.insertRow(0);var b=s.insertCell(0);var q=document.createElement("label");q.setAttribute("for",c.name);q.appendChild(document.createTextNode(l.getLang("jivemacros.macro."+d.getName()+".attr."+c.name,c.name)));b.appendChild(q);var k=s.insertCell(1);if($str(c.value)){var p=document.createElement("INPUT");p.setAttribute("name",c.name);p.setAttribute("type","text");p.setAttribute("id","_"+c.name);p.value=n.getAttribute("_"+c.name)}else{var p=document.createElement("SELECT");p.setAttribute("name",c.name);p.setAttribute("id","_"+c.name);for(var f=0;f<c.value.length;f++){var a=document.createElement("OPTION");var o=l.getLang("jivemacros.macro."+d.getName()+".preset."+c.value[f],c.value[f]);a.appendChild(document.createTextNode(o));a.value=c.value[f];if(n.getAttribute("_"+c.name)==c.value[f]){a.selected=true}p.appendChild(a)}}var m=n.attributes[c];if(m!=null){p.value=m.nodeValue}k.appendChild(p)}}tinyMCEPopup.onInit.add(init);